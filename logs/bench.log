Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:10<00:10, 10.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  7.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  7.58s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:07,  2.89it/s]Resolving data files:  26%|██▌       | 6/23 [00:00<00:01, 12.86it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 39.06it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.77s/it]100%|██████████| 1/1 [00:08<00:00,  8.77s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.12s/it]100%|██████████| 1/1 [00:11<00:00, 11.12s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.93it/s]100%|██████████| 1/1 [00:00<00:00,  1.93it/s]
0.022104646921157836 1 1 2000
0.023648280143737793 2 1 2000
0.02394334089756012 4 1 2000
0.02373609209060669 8 1 2000
0.023547930240631103 16 1 2000
0.023912492632865906 32 1 2000
0.025672593712806703 64 1 2000
0.02897623085975647 128 1 2000
0.03728779220581055 256 1 2000
0.07001901280879974 512 1 2000
0.14697761237621307 1024 1 2000
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.82s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.31s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:09,  2.41it/s]Resolving data files:  22%|██▏       | 5/23 [00:00<00:02,  7.39it/s]Resolving data files: 100%|██████████| 23/23 [00:01<00:00, 23.91it/s]Resolving data files: 100%|██████████| 23/23 [00:01<00:00, 19.07it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.51s/it]100%|██████████| 1/1 [00:08<00:00,  8.51s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:10<00:00, 11.00s/it]100%|██████████| 1/1 [00:10<00:00, 11.00s/it]
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:03,  2.40it/s] 50%|█████     | 5/10 [00:00<00:00, 11.66it/s] 90%|█████████ | 9/10 [00:00<00:00, 18.77it/s]100%|██████████| 10/10 [00:00<00:00, 15.05it/s]
0.023046477675437927 1 1000 2000
0.024121872425079346 2 1000 2000
0.02414665949344635 4 1000 2000
0.02416358184814453 8 1000 2000
0.024107395768165587 16 1000 2000
0.025036315441131593 32 1000 2000
0.02791972243785858 64 1000 2000
0.03214377903938293 128 1000 2000
0.04396830487251282 256 1000 2000
0.08662277054786682 512 1000 2000
0.18975465965270996 1024 1000 2000
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.18s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  7.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  8.56s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:14,  1.48it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 31.81it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.70s/it]100%|██████████| 1/1 [00:08<00:00,  8.70s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.03s/it]100%|██████████| 1/1 [00:11<00:00, 11.03s/it]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:08,  2.18it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.11it/s] 45%|████▌     | 9/20 [00:00<00:00, 17.80it/s] 65%|██████▌   | 13/20 [00:00<00:00, 22.21it/s] 85%|████████▌ | 17/20 [00:00<00:00, 25.05it/s]100%|██████████| 20/20 [00:01<00:00, 19.58it/s]
0.02342304289340973 1 2000 2000
0.024995194911956786 2 2000 2000
0.02483613193035126 4 2000 2000
0.024835044860839844 8 2000 2000
0.025032742142677308 16 2000 2000
0.026264527320861816 32 2000 2000
0.02992942726612091 64 2000 2000
0.03470409381389618 128 2000 2000
0.050740379333496094 256 2000 2000
0.10715060746669769 512 2000 2000
0.22924028313159941 1024 2000 2000
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.18s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.33s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:08,  2.66it/s]Resolving data files:  26%|██▌       | 6/23 [00:00<00:01, 13.08it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 41.88it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.69s/it]100%|██████████| 1/1 [00:08<00:00,  8.69s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.10s/it]100%|██████████| 1/1 [00:11<00:00, 11.10s/it]
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.18it/s] 12%|█▎        | 5/40 [00:00<00:03, 10.80it/s] 22%|██▎       | 9/40 [00:00<00:01, 17.77it/s] 32%|███▎      | 13/40 [00:00<00:01, 22.19it/s] 42%|████▎     | 17/40 [00:00<00:00, 25.05it/s] 52%|█████▎    | 21/40 [00:01<00:00, 26.85it/s] 62%|██████▎   | 25/40 [00:01<00:00, 27.84it/s] 72%|███████▎  | 29/40 [00:01<00:00, 28.28it/s] 82%|████████▎ | 33/40 [00:01<00:00, 28.34it/s] 90%|█████████ | 36/40 [00:01<00:00, 28.21it/s] 98%|█████████▊| 39/40 [00:01<00:00, 27.96it/s]100%|██████████| 40/40 [00:01<00:00, 23.21it/s]
0.02533923065662384 1 4000 2000
0.025439164042472838 2 4000 2000
0.026082619547843935 4 4000 2000
0.026208260536193847 8 4000 2000
0.02715735423564911 16 4000 2000
0.02897818875312805 32 4000 2000
0.03327232265472412 64 4000 2000
0.040822514772415164 128 4000 2000
0.07369700622558593 256 4000 2000
0.14853915107250212 512 4000 2000
0.30729813051223753 1024 4000 2000
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.05s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.27s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.84s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:07,  2.97it/s]Resolving data files:  35%|███▍      | 8/23 [00:00<00:00, 21.49it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 55.40it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 39.89it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:09<00:00,  9.19s/it]100%|██████████| 1/1 [00:09<00:00,  9.19s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.70s/it]100%|██████████| 1/1 [00:11<00:00, 11.70s/it]
  0%|          | 0/80 [00:00<?, ?it/s]  1%|▏         | 1/80 [00:01<01:43,  1.31s/it]  4%|▍         | 3/80 [00:01<00:40,  1.91it/s]  9%|▉         | 7/80 [00:01<00:13,  5.41it/s] 14%|█▍        | 11/80 [00:02<00:07,  9.21it/s] 18%|█▊        | 14/80 [00:02<00:05, 11.99it/s] 22%|██▎       | 18/80 [00:02<00:03, 16.22it/s] 28%|██▊       | 22/80 [00:02<00:02, 19.55it/s] 31%|███▏      | 25/80 [00:02<00:02, 21.65it/s] 35%|███▌      | 28/80 [00:02<00:02, 23.40it/s] 39%|███▉      | 31/80 [00:02<00:01, 24.74it/s] 42%|████▎     | 34/80 [00:02<00:01, 25.66it/s] 46%|████▋     | 37/80 [00:02<00:01, 26.22it/s] 50%|█████     | 40/80 [00:03<00:01, 26.48it/s] 54%|█████▍    | 43/80 [00:03<00:01, 26.54it/s] 57%|█████▊    | 46/80 [00:03<00:01, 26.39it/s] 61%|██████▏   | 49/80 [00:03<00:01, 26.13it/s] 65%|██████▌   | 52/80 [00:03<00:01, 25.72it/s] 69%|██████▉   | 55/80 [00:03<00:00, 25.23it/s] 72%|███████▎  | 58/80 [00:03<00:00, 24.60it/s] 76%|███████▋  | 61/80 [00:03<00:00, 23.92it/s] 80%|████████  | 64/80 [00:03<00:00, 23.20it/s] 84%|████████▍ | 67/80 [00:04<00:00, 22.51it/s] 88%|████████▊ | 70/80 [00:04<00:00, 21.81it/s] 91%|█████████▏| 73/80 [00:04<00:00, 21.14it/s] 95%|█████████▌| 76/80 [00:04<00:00, 20.43it/s] 99%|█████████▉| 79/80 [00:04<00:00, 19.76it/s]100%|██████████| 80/80 [00:04<00:00, 16.60it/s]
0.02965080392360687 1 8000 2000
0.028456643223762512 2 8000 2000
0.029457456707954407 4 8000 2000
0.030784199118614197 8 8000 2000
0.031401846408844 16 8000 2000
0.03389330554008484 32 8000 2000
0.04069623064994812 64 8000 2000
0.06902228915691376 128 8000 2000
0.118950639128685 256 8000 2000
0.22913007402420044 512 8000 2000
0.46490358805656434 1024 8000 2000
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.71s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.14s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:06,  3.18it/s]Resolving data files:  35%|███▍      | 8/23 [00:00<00:00, 23.99it/s]Resolving data files:  57%|█████▋    | 13/23 [00:00<00:00, 29.81it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 41.78it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.68s/it]100%|██████████| 1/1 [00:08<00:00,  8.68s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.02s/it]100%|██████████| 1/1 [00:11<00:00, 11.02s/it]
  0%|          | 0/160 [00:00<?, ?it/s]  1%|          | 1/160 [00:00<02:12,  1.20it/s]  3%|▎         | 5/160 [00:00<00:22,  6.83it/s]  6%|▌         | 9/160 [00:01<00:12, 12.28it/s]  8%|▊         | 13/160 [00:01<00:08, 16.88it/s] 11%|█         | 17/160 [00:01<00:06, 20.56it/s] 13%|█▎        | 21/160 [00:01<00:05, 23.32it/s] 16%|█▌        | 25/160 [00:01<00:05, 25.21it/s] 18%|█▊        | 29/160 [00:01<00:04, 26.40it/s] 21%|██        | 33/160 [00:01<00:04, 27.02it/s] 22%|██▎       | 36/160 [00:01<00:04, 27.22it/s] 24%|██▍       | 39/160 [00:02<00:04, 27.24it/s] 26%|██▋       | 42/160 [00:02<00:04, 27.12it/s] 28%|██▊       | 45/160 [00:02<00:04, 26.89it/s] 30%|███       | 48/160 [00:02<00:04, 26.55it/s] 32%|███▏      | 51/160 [00:02<00:04, 26.09it/s] 34%|███▍      | 54/160 [00:02<00:04, 25.55it/s] 36%|███▌      | 57/160 [00:02<00:04, 24.94it/s] 38%|███▊      | 60/160 [00:02<00:04, 24.22it/s] 39%|███▉      | 63/160 [00:03<00:04, 23.49it/s] 41%|████▏     | 66/160 [00:03<00:04, 22.78it/s] 43%|████▎     | 69/160 [00:03<00:04, 22.09it/s] 45%|████▌     | 72/160 [00:03<00:04, 21.38it/s] 47%|████▋     | 75/160 [00:03<00:04, 20.69it/s] 49%|████▉     | 78/160 [00:03<00:04, 20.01it/s] 51%|█████     | 81/160 [00:03<00:04, 19.34it/s] 52%|█████▏    | 83/160 [00:04<00:04, 18.87it/s] 53%|█████▎    | 85/160 [00:04<00:04, 18.38it/s] 54%|█████▍    | 87/160 [00:04<00:04, 17.87it/s] 56%|█████▌    | 89/160 [00:04<00:04, 17.39it/s] 57%|█████▋    | 91/160 [00:04<00:04, 16.95it/s] 58%|█████▊    | 93/160 [00:04<00:04, 16.56it/s] 59%|█████▉    | 95/160 [00:04<00:04, 16.20it/s] 61%|██████    | 97/160 [00:04<00:03, 15.84it/s] 62%|██████▏   | 99/160 [00:05<00:03, 15.49it/s] 63%|██████▎   | 101/160 [00:05<00:03, 15.18it/s] 64%|██████▍   | 103/160 [00:05<00:03, 14.91it/s] 66%|██████▌   | 105/160 [00:05<00:03, 14.65it/s] 67%|██████▋   | 107/160 [00:05<00:03, 14.36it/s] 68%|██████▊   | 109/160 [00:05<00:03, 14.10it/s] 69%|██████▉   | 111/160 [00:05<00:03, 13.88it/s] 71%|███████   | 113/160 [00:06<00:03, 13.66it/s] 72%|███████▏  | 115/160 [00:06<00:03, 13.43it/s] 73%|███████▎  | 117/160 [00:06<00:03, 13.21it/s] 74%|███████▍  | 119/160 [00:06<00:03, 13.00it/s] 76%|███████▌  | 121/160 [00:06<00:03, 12.79it/s] 77%|███████▋  | 123/160 [00:06<00:02, 12.60it/s] 78%|███████▊  | 125/160 [00:07<00:02, 12.42it/s] 79%|███████▉  | 127/160 [00:07<00:02, 12.24it/s] 81%|████████  | 129/160 [00:07<00:02, 12.09it/s] 82%|████████▏ | 131/160 [00:07<00:02, 11.92it/s] 83%|████████▎ | 133/160 [00:07<00:02, 11.78it/s] 84%|████████▍ | 135/160 [00:07<00:02, 11.64it/s] 86%|████████▌ | 137/160 [00:08<00:01, 11.50it/s] 87%|████████▋ | 139/160 [00:08<00:01, 11.37it/s] 88%|████████▊ | 141/160 [00:08<00:01, 11.24it/s] 89%|████████▉ | 143/160 [00:08<00:01, 11.12it/s] 91%|█████████ | 145/160 [00:08<00:01, 11.01it/s] 92%|█████████▏| 147/160 [00:09<00:01, 10.89it/s] 93%|█████████▎| 149/160 [00:09<00:01, 10.77it/s] 94%|█████████▍| 151/160 [00:09<00:00, 10.66it/s] 96%|█████████▌| 153/160 [00:09<00:00, 10.55it/s] 97%|█████████▋| 155/160 [00:09<00:00, 10.45it/s] 98%|█████████▊| 157/160 [00:10<00:00, 10.34it/s] 99%|█████████▉| 159/160 [00:10<00:00, 10.24it/s]100%|██████████| 160/160 [00:10<00:00, 15.53it/s]
0.038192198395729064 1 16000 2000
0.03543497002124786 2 16000 2000
0.036063608169555665 4 16000 2000
0.03881294882297516 8 16000 2000
0.04006947541236877 16 16000 2000
0.046548274636268615 32 16000 2000
0.07293985676765442 64 16000 2000
0.11858230245113373 128 16000 2000
0.20435695481300353 256 16000 2000
0.3904273980855942 512 16000 2000
0.8128960168361664 1024 16000 2000
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:26<00:26, 26.42s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:29<00:00, 12.52s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:29<00:00, 14.60s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:06,  3.26it/s]Resolving data files:  26%|██▌       | 6/23 [00:00<00:01, 14.95it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 42.23it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.63s/it]100%|██████████| 1/1 [00:08<00:00,  8.63s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.04s/it]100%|██████████| 1/1 [00:11<00:00, 11.04s/it]
  0%|          | 0/320 [00:00<?, ?it/s]  0%|          | 1/320 [00:00<02:28,  2.15it/s]  2%|▏         | 5/320 [00:00<00:28, 10.95it/s]  3%|▎         | 9/320 [00:00<00:17, 17.62it/s]  4%|▍         | 13/320 [00:00<00:13, 22.04it/s]  5%|▌         | 17/320 [00:00<00:12, 24.92it/s]  7%|▋         | 21/320 [00:01<00:11, 26.74it/s]  8%|▊         | 25/320 [00:01<00:10, 27.76it/s]  9%|▉         | 29/320 [00:01<00:10, 28.22it/s] 10%|█         | 33/320 [00:01<00:10, 28.29it/s] 11%|█▏        | 36/320 [00:01<00:10, 28.17it/s] 12%|█▏        | 39/320 [00:01<00:10, 27.95it/s] 13%|█▎        | 42/320 [00:01<00:10, 27.62it/s] 14%|█▍        | 45/320 [00:01<00:10, 27.22it/s] 15%|█▌        | 48/320 [00:02<00:10, 26.76it/s] 16%|█▌        | 51/320 [00:02<00:10, 26.24it/s] 17%|█▋        | 54/320 [00:02<00:10, 25.65it/s] 18%|█▊        | 57/320 [00:02<00:10, 25.00it/s] 19%|█▉        | 60/320 [00:02<00:10, 24.27it/s] 20%|█▉        | 63/320 [00:02<00:10, 23.53it/s] 21%|██        | 66/320 [00:02<00:11, 22.80it/s] 22%|██▏       | 69/320 [00:02<00:11, 22.09it/s] 22%|██▎       | 72/320 [00:03<00:11, 21.38it/s] 23%|██▎       | 75/320 [00:03<00:11, 20.71it/s] 24%|██▍       | 78/320 [00:03<00:12, 20.02it/s] 25%|██▌       | 81/320 [00:03<00:12, 19.35it/s] 26%|██▌       | 83/320 [00:03<00:12, 18.90it/s] 27%|██▋       | 85/320 [00:03<00:12, 18.43it/s] 27%|██▋       | 87/320 [00:03<00:12, 17.93it/s] 28%|██▊       | 89/320 [00:04<00:13, 17.44it/s] 28%|██▊       | 91/320 [00:04<00:13, 16.98it/s] 29%|██▉       | 93/320 [00:04<00:13, 16.57it/s] 30%|██▉       | 95/320 [00:04<00:13, 16.20it/s] 30%|███       | 97/320 [00:04<00:14, 15.86it/s] 31%|███       | 99/320 [00:04<00:14, 15.51it/s] 32%|███▏      | 101/320 [00:04<00:14, 15.19it/s] 32%|███▏      | 103/320 [00:05<00:14, 14.88it/s] 33%|███▎      | 105/320 [00:05<00:14, 14.60it/s] 33%|███▎      | 107/320 [00:05<00:14, 14.34it/s] 34%|███▍      | 109/320 [00:05<00:14, 14.10it/s] 35%|███▍      | 111/320 [00:05<00:15, 13.85it/s] 35%|███▌      | 113/320 [00:05<00:15, 13.63it/s] 36%|███▌      | 115/320 [00:05<00:15, 13.40it/s] 37%|███▋      | 117/320 [00:06<00:15, 13.18it/s] 37%|███▋      | 119/320 [00:06<00:15, 12.97it/s] 38%|███▊      | 121/320 [00:06<00:15, 12.76it/s] 38%|███▊      | 123/320 [00:06<00:15, 12.57it/s] 39%|███▉      | 125/320 [00:06<00:15, 12.39it/s] 40%|███▉      | 127/320 [00:06<00:15, 12.22it/s] 40%|████      | 129/320 [00:07<00:15, 12.08it/s] 41%|████      | 131/320 [00:07<00:15, 11.92it/s] 42%|████▏     | 133/320 [00:07<00:15, 11.77it/s] 42%|████▏     | 135/320 [00:07<00:15, 11.63it/s] 43%|████▎     | 137/320 [00:07<00:15, 11.49it/s] 43%|████▎     | 139/320 [00:07<00:15, 11.36it/s] 44%|████▍     | 141/320 [00:08<00:15, 11.23it/s] 45%|████▍     | 143/320 [00:08<00:15, 11.11it/s] 45%|████▌     | 145/320 [00:08<00:15, 11.00it/s] 46%|████▌     | 147/320 [00:08<00:15, 10.88it/s] 47%|████▋     | 149/320 [00:08<00:15, 10.77it/s] 47%|████▋     | 151/320 [00:09<00:15, 10.66it/s] 48%|████▊     | 153/320 [00:09<00:15, 10.55it/s] 48%|████▊     | 155/320 [00:09<00:15, 10.44it/s] 49%|████▉     | 157/320 [00:09<00:15, 10.34it/s] 50%|████▉     | 159/320 [00:09<00:15, 10.24it/s] 50%|█████     | 161/320 [00:10<00:15, 10.15it/s] 51%|█████     | 163/320 [00:10<00:15, 10.04it/s] 52%|█████▏    | 165/320 [00:10<00:15,  9.94it/s] 52%|█████▏    | 166/320 [00:10<00:15,  9.88it/s] 52%|█████▏    | 167/320 [00:10<00:15,  9.83it/s] 52%|█████▎    | 168/320 [00:10<00:15,  9.76it/s] 53%|█████▎    | 169/320 [00:10<00:15,  9.71it/s] 53%|█████▎    | 170/320 [00:10<00:15,  9.64it/s] 53%|█████▎    | 171/320 [00:11<00:15,  9.59it/s] 54%|█████▍    | 172/320 [00:11<00:15,  9.53it/s] 54%|█████▍    | 173/320 [00:11<00:15,  9.49it/s] 54%|█████▍    | 174/320 [00:11<00:15,  9.43it/s] 55%|█████▍    | 175/320 [00:11<00:15,  9.39it/s] 55%|█████▌    | 176/320 [00:11<00:15,  9.35it/s] 55%|█████▌    | 177/320 [00:11<00:15,  9.32it/s] 56%|█████▌    | 178/320 [00:11<00:15,  9.26it/s] 56%|█████▌    | 179/320 [00:11<00:15,  9.22it/s] 56%|█████▋    | 180/320 [00:12<00:15,  9.17it/s] 57%|█████▋    | 181/320 [00:12<00:15,  9.13it/s] 57%|█████▋    | 182/320 [00:12<00:15,  9.07it/s] 57%|█████▋    | 183/320 [00:12<00:15,  9.04it/s] 57%|█████▊    | 184/320 [00:12<00:15,  8.99it/s] 58%|█████▊    | 185/320 [00:12<00:15,  8.96it/s] 58%|█████▊    | 186/320 [00:12<00:15,  8.91it/s] 58%|█████▊    | 187/320 [00:12<00:20,  6.45it/s] 59%|█████▉    | 188/320 [00:13<00:19,  6.90it/s] 59%|█████▉    | 189/320 [00:13<00:17,  7.37it/s] 59%|█████▉    | 190/320 [00:13<00:16,  7.71it/s] 60%|█████▉    | 191/320 [00:13<00:16,  7.98it/s] 60%|██████    | 192/320 [00:13<00:15,  8.16it/s] 60%|██████    | 193/320 [00:13<00:15,  8.30it/s] 61%|██████    | 194/320 [00:13<00:15,  8.36it/s] 61%|██████    | 195/320 [00:13<00:14,  8.41it/s] 61%|██████▏   | 196/320 [00:14<00:14,  8.41it/s] 62%|██████▏   | 197/320 [00:14<00:14,  8.42it/s] 62%|██████▏   | 198/320 [00:14<00:14,  8.41it/s] 62%|██████▏   | 199/320 [00:14<00:14,  8.40it/s] 62%|██████▎   | 200/320 [00:14<00:14,  8.37it/s] 63%|██████▎   | 201/320 [00:14<00:14,  8.36it/s] 63%|██████▎   | 202/320 [00:14<00:14,  8.32it/s] 63%|██████▎   | 203/320 [00:14<00:14,  8.29it/s] 64%|██████▍   | 204/320 [00:14<00:14,  8.25it/s] 64%|██████▍   | 205/320 [00:15<00:13,  8.22it/s] 64%|██████▍   | 206/320 [00:15<00:13,  8.18it/s] 65%|██████▍   | 207/320 [00:15<00:13,  8.16it/s] 65%|██████▌   | 208/320 [00:15<00:13,  8.14it/s] 65%|██████▌   | 209/320 [00:15<00:13,  8.12it/s] 66%|██████▌   | 210/320 [00:15<00:13,  8.07it/s] 66%|██████▌   | 211/320 [00:15<00:13,  8.05it/s] 66%|██████▋   | 212/320 [00:15<00:13,  8.00it/s] 67%|██████▋   | 213/320 [00:16<00:13,  7.97it/s] 67%|██████▋   | 214/320 [00:16<00:13,  7.93it/s] 67%|██████▋   | 215/320 [00:16<00:13,  7.91it/s] 68%|██████▊   | 216/320 [00:16<00:13,  7.88it/s] 68%|██████▊   | 217/320 [00:16<00:13,  7.86it/s] 68%|██████▊   | 218/320 [00:16<00:13,  7.82it/s] 68%|██████▊   | 219/320 [00:16<00:12,  7.79it/s] 69%|██████▉   | 220/320 [00:17<00:12,  7.75it/s] 69%|██████▉   | 221/320 [00:17<00:12,  7.73it/s] 69%|██████▉   | 222/320 [00:17<00:12,  7.70it/s] 70%|██████▉   | 223/320 [00:17<00:12,  7.68it/s] 70%|███████   | 224/320 [00:17<00:12,  7.65it/s] 70%|███████   | 225/320 [00:17<00:12,  7.65it/s] 71%|███████   | 226/320 [00:17<00:12,  7.60it/s] 71%|███████   | 227/320 [00:17<00:12,  7.58it/s] 71%|███████▏  | 228/320 [00:18<00:12,  7.54it/s] 72%|███████▏  | 229/320 [00:18<00:12,  7.52it/s] 72%|███████▏  | 230/320 [00:18<00:12,  7.48it/s] 72%|███████▏  | 231/320 [00:18<00:11,  7.46it/s] 72%|███████▎  | 232/320 [00:18<00:11,  7.43it/s] 73%|███████▎  | 233/320 [00:18<00:11,  7.41it/s] 73%|███████▎  | 234/320 [00:18<00:11,  7.37it/s] 73%|███████▎  | 235/320 [00:19<00:11,  7.35it/s] 74%|███████▍  | 236/320 [00:19<00:11,  7.31it/s] 74%|███████▍  | 237/320 [00:19<00:11,  7.30it/s] 74%|███████▍  | 238/320 [00:19<00:11,  7.26it/s] 75%|███████▍  | 239/320 [00:19<00:11,  7.25it/s] 75%|███████▌  | 240/320 [00:19<00:11,  7.21it/s] 75%|███████▌  | 241/320 [00:19<00:10,  7.21it/s] 76%|███████▌  | 242/320 [00:19<00:10,  7.17it/s] 76%|███████▌  | 243/320 [00:20<00:10,  7.15it/s] 76%|███████▋  | 244/320 [00:20<00:10,  7.11it/s] 77%|███████▋  | 245/320 [00:20<00:10,  7.09it/s] 77%|███████▋  | 246/320 [00:20<00:10,  7.05it/s] 77%|███████▋  | 247/320 [00:20<00:10,  7.04it/s] 78%|███████▊  | 248/320 [00:20<00:10,  7.00it/s] 78%|███████▊  | 249/320 [00:20<00:10,  6.99it/s] 78%|███████▊  | 250/320 [00:21<00:10,  6.95it/s] 78%|███████▊  | 251/320 [00:21<00:09,  6.94it/s] 79%|███████▉  | 252/320 [00:21<00:09,  6.91it/s] 79%|███████▉  | 253/320 [00:21<00:09,  6.90it/s] 79%|███████▉  | 254/320 [00:21<00:09,  6.86it/s] 80%|███████▉  | 255/320 [00:21<00:09,  6.85it/s] 80%|████████  | 256/320 [00:22<00:09,  6.82it/s] 80%|████████  | 257/320 [00:22<00:09,  6.83it/s] 81%|████████  | 258/320 [00:22<00:09,  6.79it/s] 81%|████████  | 259/320 [00:22<00:09,  6.77it/s] 81%|████████▏ | 260/320 [00:22<00:08,  6.73it/s] 82%|████████▏ | 261/320 [00:22<00:08,  6.72it/s] 82%|████████▏ | 262/320 [00:22<00:08,  6.68it/s] 82%|████████▏ | 263/320 [00:23<00:09,  5.71it/s] 82%|████████▎ | 264/320 [00:23<00:09,  5.83it/s] 83%|████████▎ | 265/320 [00:23<00:09,  6.05it/s] 83%|████████▎ | 266/320 [00:23<00:08,  6.18it/s] 83%|████████▎ | 267/320 [00:23<00:08,  6.28it/s] 84%|████████▍ | 268/320 [00:23<00:08,  6.34it/s] 84%|████████▍ | 269/320 [00:24<00:07,  6.39it/s] 84%|████████▍ | 270/320 [00:24<00:07,  6.40it/s] 85%|████████▍ | 271/320 [00:24<00:07,  6.42it/s] 85%|████████▌ | 272/320 [00:24<00:07,  6.42it/s] 85%|████████▌ | 273/320 [00:24<00:07,  6.43it/s] 86%|████████▌ | 274/320 [00:24<00:07,  6.41it/s] 86%|████████▌ | 275/320 [00:25<00:07,  6.40it/s] 86%|████████▋ | 276/320 [00:25<00:06,  6.37it/s] 87%|████████▋ | 277/320 [00:25<00:06,  6.37it/s] 87%|████████▋ | 278/320 [00:25<00:06,  6.34it/s] 87%|████████▋ | 279/320 [00:25<00:06,  6.33it/s] 88%|████████▊ | 280/320 [00:25<00:06,  6.30it/s] 88%|████████▊ | 281/320 [00:25<00:06,  6.29it/s] 88%|████████▊ | 282/320 [00:26<00:06,  6.26it/s] 88%|████████▊ | 283/320 [00:26<00:05,  6.25it/s] 89%|████████▉ | 284/320 [00:26<00:05,  6.22it/s] 89%|████████▉ | 285/320 [00:26<00:05,  6.22it/s] 89%|████████▉ | 286/320 [00:26<00:05,  6.18it/s] 90%|████████▉ | 287/320 [00:26<00:05,  6.17it/s] 90%|█████████ | 288/320 [00:27<00:05,  6.16it/s] 90%|█████████ | 289/320 [00:27<00:05,  6.17it/s] 91%|█████████ | 290/320 [00:27<00:04,  6.13it/s] 91%|█████████ | 291/320 [00:27<00:04,  6.11it/s] 91%|█████████▏| 292/320 [00:27<00:04,  6.08it/s] 92%|█████████▏| 293/320 [00:27<00:04,  6.07it/s] 92%|█████████▏| 294/320 [00:28<00:04,  6.03it/s] 92%|█████████▏| 295/320 [00:28<00:04,  6.03it/s] 92%|█████████▎| 296/320 [00:28<00:04,  6.00it/s] 93%|█████████▎| 297/320 [00:28<00:03,  5.99it/s] 93%|█████████▎| 298/320 [00:28<00:03,  5.96it/s] 93%|█████████▎| 299/320 [00:28<00:03,  5.96it/s] 94%|█████████▍| 300/320 [00:29<00:03,  5.92it/s] 94%|█████████▍| 301/320 [00:29<00:03,  5.92it/s] 94%|█████████▍| 302/320 [00:29<00:03,  5.89it/s] 95%|█████████▍| 303/320 [00:29<00:02,  5.88it/s] 95%|█████████▌| 304/320 [00:29<00:02,  5.86it/s] 95%|█████████▌| 305/320 [00:29<00:02,  5.86it/s] 96%|█████████▌| 306/320 [00:30<00:02,  5.82it/s] 96%|█████████▌| 307/320 [00:30<00:02,  5.82it/s] 96%|█████████▋| 308/320 [00:30<00:02,  5.79it/s] 97%|█████████▋| 309/320 [00:30<00:01,  5.78it/s] 97%|█████████▋| 310/320 [00:30<00:01,  5.75it/s] 97%|█████████▋| 311/320 [00:31<00:01,  5.75it/s] 98%|█████████▊| 312/320 [00:31<00:01,  5.72it/s] 98%|█████████▊| 313/320 [00:31<00:01,  5.71it/s] 98%|█████████▊| 314/320 [00:31<00:01,  5.69it/s] 98%|█████████▊| 315/320 [00:31<00:00,  5.68it/s] 99%|█████████▉| 316/320 [00:31<00:00,  5.65it/s] 99%|█████████▉| 317/320 [00:32<00:00,  5.65it/s] 99%|█████████▉| 318/320 [00:32<00:00,  5.62it/s]100%|█████████▉| 319/320 [00:32<00:00,  5.62it/s]100%|██████████| 320/320 [00:32<00:00,  5.60it/s]100%|██████████| 320/320 [00:32<00:00,  9.81it/s]
0.05578887641429901 1 32000 2000
0.04849560499191284 2 32000 2000
0.04963038527965546 4 32000 2000
0.054676212191581725 8 32000 2000
0.0587171071767807 16 32000 2000
0.08392311072349548 32 32000 2000
0.12827080810070038 64 32000 2000
0.2105558739900589 128 32000 2000
0.37495706689357755 256 32000 2000
0.7481387532949447 512 32000 2000
1.5045421153306962 1024 32000 2000
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.92s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.85s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.31s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:08,  2.51it/s]Resolving data files:  39%|███▉      | 9/23 [00:00<00:00, 20.57it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 41.27it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.38s/it]100%|██████████| 1/1 [00:08<00:00,  8.38s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:10<00:00, 10.69s/it]100%|██████████| 1/1 [00:10<00:00, 10.69s/it]
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:00<03:35,  2.31it/s]  1%|          | 5/500 [00:00<00:42, 11.58it/s]  2%|▏         | 9/500 [00:00<00:26, 18.36it/s]  3%|▎         | 13/500 [00:00<00:21, 22.71it/s]  3%|▎         | 17/500 [00:00<00:18, 25.46it/s]  4%|▍         | 21/500 [00:01<00:17, 27.15it/s]  5%|▌         | 25/500 [00:01<00:16, 28.07it/s]  6%|▌         | 29/500 [00:01<00:16, 28.44it/s]  7%|▋         | 33/500 [00:01<00:16, 28.45it/s]  7%|▋         | 36/500 [00:01<00:16, 28.28it/s]  8%|▊         | 39/500 [00:01<00:16, 28.03it/s]  8%|▊         | 42/500 [00:01<00:16, 27.67it/s]  9%|▉         | 45/500 [00:01<00:16, 27.28it/s] 10%|▉         | 48/500 [00:01<00:16, 26.82it/s] 10%|█         | 51/500 [00:02<00:17, 26.30it/s] 11%|█         | 54/500 [00:02<00:17, 25.69it/s] 11%|█▏        | 57/500 [00:02<00:17, 25.03it/s] 12%|█▏        | 60/500 [00:02<00:18, 24.26it/s] 13%|█▎        | 63/500 [00:02<00:18, 23.50it/s] 13%|█▎        | 66/500 [00:02<00:19, 22.76it/s] 14%|█▍        | 69/500 [00:02<00:19, 22.05it/s] 14%|█▍        | 72/500 [00:03<00:20, 21.31it/s] 15%|█▌        | 75/500 [00:03<00:20, 20.62it/s] 16%|█▌        | 78/500 [00:03<00:21, 19.94it/s] 16%|█▌        | 81/500 [00:03<00:21, 19.28it/s] 17%|█▋        | 83/500 [00:03<00:22, 18.81it/s] 17%|█▋        | 85/500 [00:03<00:22, 18.33it/s] 17%|█▋        | 87/500 [00:03<00:23, 17.84it/s] 18%|█▊        | 89/500 [00:04<00:23, 17.37it/s] 18%|█▊        | 91/500 [00:04<00:24, 16.95it/s] 19%|█▊        | 93/500 [00:04<00:24, 16.56it/s] 19%|█▉        | 95/500 [00:04<00:24, 16.20it/s] 19%|█▉        | 97/500 [00:04<00:25, 15.86it/s] 20%|█▉        | 99/500 [00:04<00:25, 15.52it/s] 20%|██        | 101/500 [00:04<00:26, 15.22it/s] 21%|██        | 103/500 [00:04<00:26, 14.94it/s] 21%|██        | 105/500 [00:05<00:26, 14.68it/s] 21%|██▏       | 107/500 [00:05<00:31, 12.56it/s] 22%|██▏       | 109/500 [00:05<00:30, 12.84it/s] 22%|██▏       | 111/500 [00:05<00:29, 13.00it/s] 23%|██▎       | 113/500 [00:05<00:29, 13.06it/s] 23%|██▎       | 115/500 [00:05<00:29, 13.03it/s] 23%|██▎       | 117/500 [00:06<00:29, 12.95it/s] 24%|██▍       | 119/500 [00:06<00:29, 12.83it/s] 24%|██▍       | 121/500 [00:06<00:29, 12.69it/s] 25%|██▍       | 123/500 [00:06<00:30, 12.54it/s] 25%|██▌       | 125/500 [00:06<00:30, 12.37it/s] 25%|██▌       | 127/500 [00:06<00:30, 12.21it/s] 26%|██▌       | 129/500 [00:07<00:30, 12.08it/s] 26%|██▌       | 131/500 [00:07<00:30, 11.92it/s] 27%|██▋       | 133/500 [00:07<00:31, 11.78it/s] 27%|██▋       | 135/500 [00:07<00:31, 11.64it/s] 27%|██▋       | 137/500 [00:07<00:31, 11.50it/s] 28%|██▊       | 139/500 [00:07<00:31, 11.37it/s] 28%|██▊       | 141/500 [00:08<00:31, 11.24it/s] 29%|██▊       | 143/500 [00:08<00:32, 11.12it/s] 29%|██▉       | 145/500 [00:08<00:32, 11.01it/s] 29%|██▉       | 147/500 [00:08<00:32, 10.89it/s] 30%|██▉       | 149/500 [00:08<00:34, 10.08it/s] 30%|███       | 151/500 [00:09<00:34, 10.17it/s] 31%|███       | 153/500 [00:09<00:33, 10.21it/s] 31%|███       | 155/500 [00:09<00:33, 10.21it/s] 31%|███▏      | 157/500 [00:09<00:33, 10.18it/s] 32%|███▏      | 159/500 [00:09<00:33, 10.12it/s] 32%|███▏      | 161/500 [00:10<00:33, 10.07it/s] 33%|███▎      | 163/500 [00:10<00:33,  9.99it/s] 33%|███▎      | 164/500 [00:10<00:33,  9.93it/s] 33%|███▎      | 165/500 [00:10<00:33,  9.89it/s] 33%|███▎      | 166/500 [00:10<00:34,  9.82it/s] 33%|███▎      | 167/500 [00:10<00:34,  9.77it/s] 34%|███▎      | 168/500 [00:10<00:34,  9.71it/s] 34%|███▍      | 169/500 [00:10<00:34,  9.66it/s] 34%|███▍      | 170/500 [00:11<00:34,  9.60it/s] 34%|███▍      | 171/500 [00:11<00:34,  9.55it/s] 34%|███▍      | 172/500 [00:11<00:34,  9.49it/s] 35%|███▍      | 173/500 [00:11<00:34,  9.46it/s] 35%|███▍      | 174/500 [00:11<00:34,  9.40it/s] 35%|███▌      | 175/500 [00:11<00:34,  9.37it/s] 35%|███▌      | 176/500 [00:11<00:34,  9.32it/s] 35%|███▌      | 177/500 [00:11<00:34,  9.30it/s] 36%|███▌      | 178/500 [00:11<00:34,  9.24it/s] 36%|███▌      | 179/500 [00:12<00:34,  9.20it/s] 36%|███▌      | 180/500 [00:12<00:34,  9.15it/s] 36%|███▌      | 181/500 [00:12<00:38,  8.31it/s] 36%|███▋      | 182/500 [00:12<00:37,  8.47it/s] 37%|███▋      | 183/500 [00:12<00:36,  8.61it/s] 37%|███▋      | 184/500 [00:12<00:36,  8.69it/s] 37%|███▋      | 185/500 [00:12<00:36,  8.75it/s] 37%|███▋      | 186/500 [00:12<00:35,  8.76it/s] 37%|███▋      | 187/500 [00:12<00:35,  8.78it/s] 38%|███▊      | 188/500 [00:13<00:35,  8.76it/s] 38%|███▊      | 189/500 [00:13<00:35,  8.75it/s] 38%|███▊      | 190/500 [00:13<00:35,  8.72it/s] 38%|███▊      | 191/500 [00:13<00:35,  8.71it/s] 38%|███▊      | 192/500 [00:13<00:35,  8.67it/s] 39%|███▊      | 193/500 [00:13<00:35,  8.67it/s] 39%|███▉      | 194/500 [00:13<00:35,  8.61it/s] 39%|███▉      | 195/500 [00:13<00:35,  8.58it/s] 39%|███▉      | 196/500 [00:13<00:35,  8.53it/s] 39%|███▉      | 197/500 [00:14<00:35,  8.51it/s] 40%|███▉      | 198/500 [00:14<00:35,  8.46it/s] 40%|███▉      | 199/500 [00:14<00:35,  8.44it/s] 40%|████      | 200/500 [00:14<00:35,  8.39it/s] 40%|████      | 201/500 [00:14<00:35,  8.37it/s] 40%|████      | 202/500 [00:14<00:35,  8.32it/s] 41%|████      | 203/500 [00:14<00:35,  8.30it/s] 41%|████      | 204/500 [00:14<00:35,  8.25it/s] 41%|████      | 205/500 [00:15<00:35,  8.22it/s] 41%|████      | 206/500 [00:15<00:35,  8.17it/s] 41%|████▏     | 207/500 [00:15<00:38,  7.56it/s] 42%|████▏     | 208/500 [00:15<00:37,  7.69it/s] 42%|████▏     | 209/500 [00:15<00:37,  7.80it/s] 42%|████▏     | 210/500 [00:15<00:36,  7.84it/s] 42%|████▏     | 211/500 [00:15<00:36,  7.89it/s] 42%|████▏     | 212/500 [00:15<00:36,  7.88it/s] 43%|████▎     | 213/500 [00:16<00:36,  7.89it/s] 43%|████▎     | 214/500 [00:16<00:36,  7.87it/s] 43%|████▎     | 215/500 [00:16<00:36,  7.87it/s] 43%|████▎     | 216/500 [00:16<00:36,  7.84it/s] 43%|████▎     | 217/500 [00:16<00:36,  7.83it/s] 44%|████▎     | 218/500 [00:16<00:36,  7.79it/s] 44%|████▍     | 219/500 [00:16<00:36,  7.78it/s] 44%|████▍     | 220/500 [00:17<00:36,  7.74it/s] 44%|████▍     | 221/500 [00:17<00:36,  7.72it/s] 44%|████▍     | 222/500 [00:17<00:36,  7.68it/s] 45%|████▍     | 223/500 [00:17<00:36,  7.67it/s] 45%|████▍     | 224/500 [00:17<00:36,  7.64it/s] 45%|████▌     | 225/500 [00:17<00:35,  7.64it/s] 45%|████▌     | 226/500 [00:17<00:36,  7.60it/s] 45%|████▌     | 227/500 [00:17<00:36,  7.57it/s] 46%|████▌     | 228/500 [00:18<00:36,  7.53it/s] 46%|████▌     | 229/500 [00:18<00:36,  7.51it/s] 46%|████▌     | 230/500 [00:18<00:38,  7.02it/s] 46%|████▌     | 231/500 [00:18<00:37,  7.13it/s] 46%|████▋     | 232/500 [00:18<00:37,  7.19it/s] 47%|████▋     | 233/500 [00:18<00:36,  7.24it/s] 47%|████▋     | 234/500 [00:18<00:36,  7.24it/s] 47%|████▋     | 235/500 [00:19<00:36,  7.26it/s] 47%|████▋     | 236/500 [00:19<00:36,  7.24it/s] 47%|████▋     | 237/500 [00:19<00:36,  7.25it/s] 48%|████▊     | 238/500 [00:19<00:36,  7.22it/s] 48%|████▊     | 239/500 [00:19<00:36,  7.22it/s] 48%|████▊     | 240/500 [00:19<00:36,  7.19it/s] 48%|████▊     | 241/500 [00:19<00:36,  7.19it/s] 48%|████▊     | 242/500 [00:20<00:36,  7.15it/s] 49%|████▊     | 243/500 [00:20<00:36,  7.13it/s] 49%|████▉     | 244/500 [00:20<00:36,  7.09it/s] 49%|████▉     | 245/500 [00:20<00:36,  7.08it/s] 49%|████▉     | 246/500 [00:20<00:36,  7.03it/s] 49%|████▉     | 247/500 [00:20<00:36,  7.02it/s] 50%|████▉     | 248/500 [00:20<00:36,  6.99it/s] 50%|████▉     | 249/500 [00:21<00:35,  6.98it/s] 50%|█████     | 250/500 [00:21<00:36,  6.93it/s] 50%|█████     | 251/500 [00:21<00:38,  6.54it/s] 50%|█████     | 252/500 [00:21<00:37,  6.61it/s] 51%|█████     | 253/500 [00:21<00:36,  6.68it/s] 51%|█████     | 254/500 [00:21<00:36,  6.71it/s] 51%|█████     | 255/500 [00:21<00:36,  6.74it/s] 51%|█████     | 256/500 [00:22<00:36,  6.75it/s] 51%|█████▏    | 257/500 [00:22<00:35,  6.77it/s] 52%|█████▏    | 258/500 [00:22<00:35,  6.74it/s] 52%|█████▏    | 259/500 [00:22<00:35,  6.73it/s] 52%|█████▏    | 260/500 [00:22<00:35,  6.70it/s] 52%|█████▏    | 261/500 [00:22<00:35,  6.69it/s] 52%|█████▏    | 262/500 [00:22<00:35,  6.66it/s] 53%|█████▎    | 263/500 [00:23<00:35,  6.65it/s] 53%|█████▎    | 264/500 [00:23<00:35,  6.62it/s] 53%|█████▎    | 265/500 [00:23<00:35,  6.61it/s] 53%|█████▎    | 266/500 [00:23<00:35,  6.57it/s] 53%|█████▎    | 267/500 [00:23<00:35,  6.57it/s] 54%|█████▎    | 268/500 [00:23<00:35,  6.53it/s] 54%|█████▍    | 269/500 [00:24<00:35,  6.52it/s] 54%|█████▍    | 270/500 [00:24<00:35,  6.49it/s] 54%|█████▍    | 271/500 [00:24<00:37,  6.15it/s] 54%|█████▍    | 272/500 [00:24<00:36,  6.22it/s] 55%|█████▍    | 273/500 [00:24<00:36,  6.29it/s] 55%|█████▍    | 274/500 [00:24<00:35,  6.30it/s] 55%|█████▌    | 275/500 [00:25<00:35,  6.33it/s] 55%|█████▌    | 276/500 [00:25<00:35,  6.32it/s] 55%|█████▌    | 277/500 [00:25<00:35,  6.33it/s] 56%|█████▌    | 278/500 [00:25<00:35,  6.31it/s] 56%|█████▌    | 279/500 [00:25<00:35,  6.31it/s] 56%|█████▌    | 280/500 [00:25<00:35,  6.28it/s] 56%|█████▌    | 281/500 [00:25<00:34,  6.28it/s] 56%|█████▋    | 282/500 [00:26<00:34,  6.24it/s] 57%|█████▋    | 283/500 [00:26<00:34,  6.24it/s] 57%|█████▋    | 284/500 [00:26<00:34,  6.21it/s] 57%|█████▋    | 285/500 [00:26<00:34,  6.21it/s] 57%|█████▋    | 286/500 [00:26<00:34,  6.18it/s] 57%|█████▋    | 287/500 [00:26<00:34,  6.17it/s] 58%|█████▊    | 288/500 [00:27<00:34,  6.15it/s] 58%|█████▊    | 289/500 [00:27<00:35,  5.87it/s] 58%|█████▊    | 290/500 [00:27<00:35,  5.92it/s] 58%|█████▊    | 291/500 [00:27<00:35,  5.97it/s] 58%|█████▊    | 292/500 [00:27<00:34,  5.98it/s] 59%|█████▊    | 293/500 [00:27<00:34,  6.00it/s] 59%|█████▉    | 294/500 [00:28<00:34,  5.98it/s] 59%|█████▉    | 295/500 [00:28<00:34,  5.99it/s] 59%|█████▉    | 296/500 [00:28<00:34,  5.97it/s] 59%|█████▉    | 297/500 [00:28<00:33,  5.97it/s] 60%|█████▉    | 298/500 [00:28<00:33,  5.95it/s] 60%|█████▉    | 299/500 [00:28<00:33,  5.94it/s] 60%|██████    | 300/500 [00:29<00:33,  5.91it/s] 60%|██████    | 301/500 [00:29<00:33,  5.91it/s] 60%|██████    | 302/500 [00:29<00:33,  5.88it/s] 61%|██████    | 303/500 [00:29<00:33,  5.88it/s] 61%|██████    | 304/500 [00:29<00:33,  5.85it/s] 61%|██████    | 305/500 [00:30<00:34,  5.61it/s] 61%|██████    | 306/500 [00:30<00:34,  5.65it/s] 61%|██████▏   | 307/500 [00:30<00:33,  5.70it/s] 62%|██████▏   | 308/500 [00:30<00:33,  5.70it/s] 62%|██████▏   | 309/500 [00:30<00:33,  5.72it/s] 62%|██████▏   | 310/500 [00:30<00:33,  5.71it/s] 62%|██████▏   | 311/500 [00:31<00:33,  5.72it/s] 62%|██████▏   | 312/500 [00:31<00:32,  5.70it/s] 63%|██████▎   | 313/500 [00:31<00:32,  5.70it/s] 63%|██████▎   | 314/500 [00:31<00:32,  5.68it/s] 63%|██████▎   | 315/500 [00:31<00:32,  5.67it/s] 63%|██████▎   | 316/500 [00:31<00:32,  5.65it/s] 63%|██████▎   | 317/500 [00:32<00:32,  5.65it/s] 64%|██████▎   | 318/500 [00:32<00:32,  5.62it/s] 64%|██████▍   | 319/500 [00:32<00:32,  5.62it/s] 64%|██████▍   | 320/500 [00:32<00:33,  5.30it/s] 64%|██████▍   | 321/500 [00:32<00:33,  5.39it/s] 64%|██████▍   | 322/500 [00:33<00:32,  5.42it/s] 65%|██████▍   | 323/500 [00:33<00:32,  5.46it/s] 65%|██████▍   | 324/500 [00:33<00:32,  5.46it/s] 65%|██████▌   | 325/500 [00:33<00:31,  5.48it/s] 65%|██████▌   | 326/500 [00:33<00:31,  5.46it/s] 65%|██████▌   | 327/500 [00:33<00:31,  5.47it/s] 66%|██████▌   | 328/500 [00:34<00:31,  5.45it/s] 66%|██████▌   | 329/500 [00:34<00:31,  5.45it/s] 66%|██████▌   | 330/500 [00:34<00:31,  5.42it/s] 66%|██████▌   | 331/500 [00:34<00:31,  5.42it/s] 66%|██████▋   | 332/500 [00:34<00:31,  5.39it/s] 67%|██████▋   | 333/500 [00:35<00:30,  5.39it/s] 67%|██████▋   | 334/500 [00:35<00:30,  5.36it/s] 67%|██████▋   | 335/500 [00:35<00:32,  5.09it/s] 67%|██████▋   | 336/500 [00:35<00:31,  5.15it/s] 67%|██████▋   | 337/500 [00:35<00:31,  5.21it/s] 68%|██████▊   | 338/500 [00:36<00:31,  5.22it/s] 68%|██████▊   | 339/500 [00:36<00:30,  5.25it/s] 68%|██████▊   | 340/500 [00:36<00:30,  5.24it/s] 68%|██████▊   | 341/500 [00:36<00:30,  5.26it/s] 68%|██████▊   | 342/500 [00:36<00:30,  5.24it/s] 69%|██████▊   | 343/500 [00:37<00:29,  5.24it/s] 69%|██████▉   | 344/500 [00:37<00:29,  5.22it/s] 69%|██████▉   | 345/500 [00:37<00:29,  5.23it/s] 69%|██████▉   | 346/500 [00:37<00:29,  5.20it/s] 69%|██████▉   | 347/500 [00:37<00:29,  5.20it/s] 70%|██████▉   | 348/500 [00:37<00:29,  5.17it/s] 70%|██████▉   | 349/500 [00:38<00:30,  4.91it/s] 70%|███████   | 350/500 [00:38<00:30,  4.96it/s] 70%|███████   | 351/500 [00:38<00:29,  5.01it/s] 70%|███████   | 352/500 [00:38<00:29,  5.03it/s] 71%|███████   | 353/500 [00:38<00:28,  5.08it/s] 71%|███████   | 354/500 [00:39<00:28,  5.06it/s] 71%|███████   | 355/500 [00:39<00:28,  5.07it/s] 71%|███████   | 356/500 [00:39<00:28,  5.05it/s] 71%|███████▏  | 357/500 [00:39<00:28,  5.05it/s] 72%|███████▏  | 358/500 [00:39<00:28,  5.03it/s] 72%|███████▏  | 359/500 [00:40<00:28,  5.03it/s] 72%|███████▏  | 360/500 [00:40<00:27,  5.01it/s] 72%|███████▏  | 361/500 [00:40<00:27,  5.01it/s] 72%|███████▏  | 362/500 [00:40<00:27,  4.99it/s] 73%|███████▎  | 363/500 [00:41<00:28,  4.81it/s] 73%|███████▎  | 364/500 [00:41<00:28,  4.84it/s] 73%|███████▎  | 365/500 [00:41<00:27,  4.87it/s] 73%|███████▎  | 366/500 [00:41<00:27,  4.87it/s] 73%|███████▎  | 367/500 [00:41<00:27,  4.89it/s] 74%|███████▎  | 368/500 [00:42<00:27,  4.88it/s] 74%|███████▍  | 369/500 [00:42<00:26,  4.90it/s] 74%|███████▍  | 370/500 [00:42<00:26,  4.87it/s] 74%|███████▍  | 371/500 [00:42<00:26,  4.88it/s] 74%|███████▍  | 372/500 [00:42<00:26,  4.85it/s] 75%|███████▍  | 373/500 [00:43<00:26,  4.85it/s] 75%|███████▍  | 374/500 [00:43<00:26,  4.83it/s] 75%|███████▌  | 375/500 [00:43<00:25,  4.83it/s] 75%|███████▌  | 376/500 [00:43<00:26,  4.62it/s] 75%|███████▌  | 377/500 [00:43<00:26,  4.68it/s] 76%|███████▌  | 378/500 [00:44<00:25,  4.70it/s] 76%|███████▌  | 379/500 [00:44<00:25,  4.72it/s] 76%|███████▌  | 380/500 [00:44<00:25,  4.72it/s] 76%|███████▌  | 381/500 [00:44<00:25,  4.73it/s] 76%|███████▋  | 382/500 [00:44<00:25,  4.72it/s] 77%|███████▋  | 383/500 [00:45<00:24,  4.72it/s] 77%|███████▋  | 384/500 [00:45<00:24,  4.71it/s] 77%|███████▋  | 385/500 [00:45<00:24,  4.73it/s] 77%|███████▋  | 386/500 [00:45<00:24,  4.70it/s] 77%|███████▋  | 387/500 [00:46<00:24,  4.70it/s] 78%|███████▊  | 388/500 [00:46<00:23,  4.67it/s] 78%|███████▊  | 389/500 [00:46<00:25,  4.43it/s] 78%|███████▊  | 390/500 [00:46<00:24,  4.47it/s] 78%|███████▊  | 391/500 [00:46<00:24,  4.52it/s] 78%|███████▊  | 392/500 [00:47<00:23,  4.53it/s] 79%|███████▊  | 393/500 [00:47<00:23,  4.56it/s] 79%|███████▉  | 394/500 [00:47<00:23,  4.56it/s] 79%|███████▉  | 395/500 [00:47<00:22,  4.57it/s] 79%|███████▉  | 396/500 [00:48<00:22,  4.55it/s] 79%|███████▉  | 397/500 [00:48<00:22,  4.56it/s] 80%|███████▉  | 398/500 [00:48<00:22,  4.54it/s] 80%|███████▉  | 399/500 [00:48<00:22,  4.54it/s] 80%|████████  | 400/500 [00:48<00:22,  4.39it/s] 80%|████████  | 401/500 [00:49<00:22,  4.44it/s] 80%|████████  | 402/500 [00:49<00:22,  4.44it/s] 81%|████████  | 403/500 [00:49<00:21,  4.46it/s] 81%|████████  | 404/500 [00:49<00:21,  4.45it/s] 81%|████████  | 405/500 [00:50<00:21,  4.46it/s] 81%|████████  | 406/500 [00:50<00:21,  4.45it/s] 81%|████████▏ | 407/500 [00:50<00:20,  4.45it/s] 82%|████████▏ | 408/500 [00:50<00:20,  4.43it/s] 82%|████████▏ | 409/500 [00:50<00:20,  4.44it/s] 82%|████████▏ | 410/500 [00:51<00:20,  4.42it/s] 82%|████████▏ | 411/500 [00:51<00:20,  4.42it/s] 82%|████████▏ | 412/500 [00:51<00:20,  4.27it/s] 83%|████████▎ | 413/500 [00:51<00:20,  4.31it/s] 83%|████████▎ | 414/500 [00:52<00:19,  4.31it/s] 83%|████████▎ | 415/500 [00:52<00:19,  4.34it/s] 83%|████████▎ | 416/500 [00:52<00:19,  4.34it/s] 83%|████████▎ | 417/500 [00:52<00:19,  4.36it/s] 84%|████████▎ | 418/500 [00:53<00:18,  4.33it/s] 84%|████████▍ | 419/500 [00:53<00:18,  4.34it/s] 84%|████████▍ | 420/500 [00:53<00:18,  4.31it/s] 84%|████████▍ | 421/500 [00:53<00:18,  4.32it/s] 84%|████████▍ | 422/500 [00:53<00:18,  4.29it/s] 85%|████████▍ | 423/500 [00:54<00:18,  4.10it/s] 85%|████████▍ | 424/500 [00:54<00:18,  4.14it/s] 85%|████████▌ | 425/500 [00:54<00:17,  4.18it/s] 85%|████████▌ | 426/500 [00:54<00:17,  4.19it/s] 85%|████████▌ | 427/500 [00:55<00:17,  4.21it/s] 86%|████████▌ | 428/500 [00:55<00:17,  4.20it/s] 86%|████████▌ | 429/500 [00:55<00:16,  4.21it/s] 86%|████████▌ | 430/500 [00:55<00:16,  4.19it/s] 86%|████████▌ | 431/500 [00:56<00:16,  4.20it/s] 86%|████████▋ | 432/500 [00:56<00:16,  4.18it/s] 87%|████████▋ | 433/500 [00:56<00:17,  3.93it/s] 87%|████████▋ | 434/500 [00:56<00:16,  3.99it/s] 87%|████████▋ | 435/500 [00:57<00:16,  4.04it/s] 87%|████████▋ | 436/500 [00:57<00:15,  4.06it/s] 87%|████████▋ | 437/500 [00:57<00:15,  4.09it/s] 88%|████████▊ | 438/500 [00:57<00:15,  4.09it/s] 88%|████████▊ | 439/500 [00:58<00:14,  4.10it/s] 88%|████████▊ | 440/500 [00:58<00:14,  4.09it/s] 88%|████████▊ | 441/500 [00:58<00:14,  4.10it/s] 88%|████████▊ | 442/500 [00:58<00:14,  4.09it/s] 89%|████████▊ | 443/500 [00:59<00:14,  3.85it/s] 89%|████████▉ | 444/500 [00:59<00:14,  3.90it/s] 89%|████████▉ | 445/500 [00:59<00:13,  3.96it/s] 89%|████████▉ | 446/500 [00:59<00:13,  3.97it/s] 89%|████████▉ | 447/500 [01:00<00:13,  4.00it/s] 90%|████████▉ | 448/500 [01:00<00:12,  4.01it/s] 90%|████████▉ | 449/500 [01:00<00:12,  4.03it/s] 90%|█████████ | 450/500 [01:00<00:12,  4.02it/s] 90%|█████████ | 451/500 [01:01<00:12,  4.02it/s] 90%|█████████ | 452/500 [01:01<00:11,  4.00it/s] 91%|█████████ | 453/500 [01:01<00:12,  3.86it/s] 91%|█████████ | 454/500 [01:01<00:11,  3.88it/s] 91%|█████████ | 455/500 [01:02<00:11,  3.92it/s] 91%|█████████ | 456/500 [01:02<00:11,  3.92it/s] 91%|█████████▏| 457/500 [01:02<00:10,  3.94it/s] 92%|█████████▏| 458/500 [01:02<00:10,  3.93it/s] 92%|█████████▏| 459/500 [01:03<00:10,  3.94it/s] 92%|█████████▏| 460/500 [01:03<00:10,  3.93it/s] 92%|█████████▏| 461/500 [01:03<00:09,  3.94it/s] 92%|█████████▏| 462/500 [01:03<00:09,  3.92it/s] 93%|█████████▎| 463/500 [01:04<00:10,  3.69it/s] 93%|█████████▎| 464/500 [01:04<00:09,  3.74it/s] 93%|█████████▎| 465/500 [01:04<00:09,  3.80it/s] 93%|█████████▎| 466/500 [01:05<00:08,  3.81it/s] 93%|█████████▎| 467/500 [01:05<00:08,  3.84it/s] 94%|█████████▎| 468/500 [01:05<00:08,  3.83it/s] 94%|█████████▍| 469/500 [01:05<00:08,  3.85it/s] 94%|█████████▍| 470/500 [01:06<00:07,  3.84it/s] 94%|█████████▍| 471/500 [01:06<00:07,  3.84it/s] 94%|█████████▍| 472/500 [01:06<00:07,  3.65it/s] 95%|█████████▍| 473/500 [01:06<00:07,  3.71it/s] 95%|█████████▍| 474/500 [01:07<00:06,  3.73it/s] 95%|█████████▌| 475/500 [01:07<00:06,  3.76it/s] 95%|█████████▌| 476/500 [01:07<00:06,  3.76it/s] 95%|█████████▌| 477/500 [01:07<00:06,  3.78it/s] 96%|█████████▌| 478/500 [01:08<00:05,  3.77it/s] 96%|█████████▌| 479/500 [01:08<00:05,  3.78it/s] 96%|█████████▌| 480/500 [01:08<00:05,  3.77it/s] 96%|█████████▌| 481/500 [01:09<00:05,  3.65it/s] 96%|█████████▋| 482/500 [01:09<00:04,  3.67it/s] 97%|█████████▋| 483/500 [01:09<00:04,  3.70it/s] 97%|█████████▋| 484/500 [01:09<00:04,  3.70it/s] 97%|█████████▋| 485/500 [01:10<00:04,  3.71it/s] 97%|█████████▋| 486/500 [01:10<00:03,  3.70it/s] 97%|█████████▋| 487/500 [01:10<00:03,  3.71it/s] 98%|█████████▊| 488/500 [01:10<00:03,  3.70it/s] 98%|█████████▊| 489/500 [01:11<00:03,  3.57it/s] 98%|█████████▊| 490/500 [01:11<00:02,  3.59it/s] 98%|█████████▊| 491/500 [01:11<00:02,  3.62it/s] 98%|█████████▊| 492/500 [01:12<00:02,  3.62it/s] 99%|█████████▊| 493/500 [01:12<00:01,  3.64it/s] 99%|█████████▉| 494/500 [01:12<00:01,  3.63it/s] 99%|█████████▉| 495/500 [01:12<00:01,  3.64it/s] 99%|█████████▉| 496/500 [01:13<00:01,  3.63it/s] 99%|█████████▉| 497/500 [01:13<00:00,  3.50it/s]100%|█████████▉| 498/500 [01:13<00:00,  3.53it/s]100%|█████████▉| 499/500 [01:14<00:00,  3.56it/s]100%|██████████| 500/500 [01:14<00:00,  3.56it/s]100%|██████████| 500/500 [01:14<00:00,  6.73it/s]
0.07593757271766663 1 50000 2000
0.0632094839811325 2 50000 2000
0.06497312271595002 4 50000 2000
0.07445155000686646 8 50000 2000
0.08542935109138489 16 50000 2000
0.12400161266326905 32 50000 2000
0.19396844291687013 64 50000 2000
0.33090732562541963 128 50000 2000
0.6107928264141083 256 50000 2000
Traceback (most recent call last):
  File "/home/hanshis/workspace/LongContextInfer/benchmark_cache.py", line 57, in <module>
    outputs = model(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_cache.py", line 1253, in forward
    outputs = self.model(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_cache.py", line 1139, in forward
    layer_outputs = decoder_layer(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_cache.py", line 865, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_cache.py", line 772, in forward
    attn_weights = nn.functional.softmax(attn_weights, dim=-1, dtype=torch.float32).to(query_states.dtype)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/functional.py", line 1858, in softmax
    ret = input.softmax(dim, dtype=dtype)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.08 GiB. GPU 0 has a total capacty of 44.32 GiB of which 2.33 GiB is free. Including non-PyTorch memory, this process has 41.97 GiB memory in use. Of the allocated memory 41.19 GiB is allocated by PyTorch, and 291.29 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.67s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.13s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:07,  2.95it/s]Resolving data files:  39%|███▉      | 9/23 [00:00<00:00, 19.58it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 41.07it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:09<00:00,  9.42s/it]100%|██████████| 1/1 [00:09<00:00,  9.42s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:12<00:00, 12.24s/it]100%|██████████| 1/1 [00:12<00:00, 12.24s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.88s/it]100%|██████████| 1/1 [00:01<00:00,  1.88s/it]
Cached Size: 1 | Max Budget: 1201
0.024821518301963805 1 1 2000
0.02607327425479889 2 1 2000
0.02540908670425415 4 1 2000
0.02554918873310089 8 1 2000
0.025804988026618958 16 1 2000
0.026448079228401183 32 1 2000
0.02832605791091919 64 1 2000
0.031043057918548583 128 1 2000
0.03534756910800934 256 1 2000
0.06294539427757263 512 1 2000
0.11200791394710541 1024 1 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.06s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:08,  2.73it/s]Resolving data files:  26%|██▌       | 6/23 [00:00<00:01, 12.72it/s]Resolving data files:  35%|███▍      | 8/23 [00:00<00:01, 12.83it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 31.91it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:09<00:00,  9.40s/it]100%|██████████| 1/1 [00:09<00:00,  9.40s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:12<00:00, 12.02s/it]100%|██████████| 1/1 [00:12<00:00, 12.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:04,  2.10it/s] 50%|█████     | 5/10 [00:00<00:00, 10.26it/s] 90%|█████████ | 9/10 [00:00<00:00, 16.43it/s]100%|██████████| 10/10 [00:00<00:00, 13.24it/s]
Cached Size: 1000 | Max Budget: 2200
0.02522915482521057 1 1000 2000
0.025626835107803343 2 1000 2000
0.025693188786506654 4 1000 2000
0.02586431872844696 8 1000 2000
0.02619233560562134 16 1000 2000
0.02683498203754425 32 1000 2000
0.028705677032470702 64 1000 2000
0.030755611181259156 128 1000 2000
0.0365657262802124 256 1000 2000
0.0659195386171341 512 1000 2000
0.11690410792827606 1024 1000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.70s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.22s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:08,  2.68it/s]Resolving data files:  13%|█▎        | 3/23 [00:00<00:02,  7.06it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 43.79it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.77s/it]100%|██████████| 1/1 [00:08<00:00,  8.77s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.17s/it]100%|██████████| 1/1 [00:11<00:00, 11.17s/it]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:07,  2.41it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.34it/s] 45%|████▌     | 9/20 [00:00<00:00, 17.71it/s] 65%|██████▌   | 13/20 [00:00<00:00, 22.20it/s] 85%|████████▌ | 17/20 [00:00<00:00, 25.35it/s]100%|██████████| 20/20 [00:00<00:00, 20.04it/s]
Cached Size: 2000 | Max Budget: 3200
0.02499607753753662 1 2000 2000
0.02566984498500824 2 2000 2000
0.025538540482521056 4 2000 2000
0.025634042382240294 8 2000 2000
0.025887778282165527 16 2000 2000
0.026686986327171324 32 2000 2000
0.02861348295211792 64 2000 2000
0.030469911098480226 128 2000 2000
0.038067754983901976 256 2000 2000
0.06863476192951203 512 2000 2000
0.12258101832866669 1024 2000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.99s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.44s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:15,  1.38it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 31.63it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.67s/it]100%|██████████| 1/1 [00:08<00:00,  8.67s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.05s/it]100%|██████████| 1/1 [00:11<00:00, 11.05s/it]
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:15,  2.52it/s] 12%|█▎        | 5/40 [00:00<00:02, 11.69it/s] 22%|██▎       | 9/40 [00:00<00:01, 18.06it/s] 32%|███▎      | 13/40 [00:00<00:01, 22.49it/s] 42%|████▎     | 17/40 [00:00<00:00, 25.54it/s] 52%|█████▎    | 21/40 [00:01<00:00, 27.68it/s] 62%|██████▎   | 25/40 [00:01<00:00, 29.16it/s] 72%|███████▎  | 29/40 [00:01<00:00, 30.06it/s] 82%|████████▎ | 33/40 [00:01<00:00, 30.81it/s] 92%|█████████▎| 37/40 [00:01<00:00, 31.35it/s]100%|██████████| 40/40 [00:01<00:00, 25.06it/s]
Cached Size: 4000 | Max Budget: 5200
0.0250481276512146 1 4000 2000
0.025634002566337584 2 4000 2000
0.02559939467906952 4 4000 2000
0.025792307019233705 8 4000 2000
0.025997901678085328 16 4000 2000
0.02676486587524414 32 4000 2000
0.028689775228500365 64 4000 2000
0.030976142168045045 128 4000 2000
0.041223268508911136 256 4000 2000
0.07425449633598327 512 4000 2000
0.13187398743629455 1024 4000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.82s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.99s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.41s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:07,  2.88it/s]Resolving data files:  48%|████▊     | 11/23 [00:00<00:00, 23.43it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 35.91it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.68s/it]100%|██████████| 1/1 [00:08<00:00,  8.68s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.14s/it]100%|██████████| 1/1 [00:11<00:00, 11.14s/it]
  0%|          | 0/80 [00:00<?, ?it/s]  1%|▏         | 1/80 [00:00<00:30,  2.56it/s]  6%|▋         | 5/80 [00:00<00:06, 11.85it/s] 11%|█▏        | 9/80 [00:00<00:03, 18.25it/s] 16%|█▋        | 13/80 [00:00<00:02, 22.71it/s] 21%|██▏       | 17/80 [00:00<00:02, 25.80it/s] 26%|██▋       | 21/80 [00:01<00:02, 27.78it/s] 31%|███▏      | 25/80 [00:01<00:01, 29.30it/s] 36%|███▋      | 29/80 [00:01<00:01, 30.36it/s] 41%|████▏     | 33/80 [00:01<00:01, 31.13it/s] 46%|████▋     | 37/80 [00:01<00:01, 31.64it/s] 51%|█████▏    | 41/80 [00:01<00:01, 31.91it/s] 56%|█████▋    | 45/80 [00:01<00:01, 32.03it/s] 61%|██████▏   | 49/80 [00:01<00:00, 32.02it/s] 66%|██████▋   | 53/80 [00:01<00:00, 31.93it/s] 71%|███████▏  | 57/80 [00:02<00:00, 31.75it/s] 76%|███████▋  | 61/80 [00:02<00:00, 31.54it/s] 81%|████████▏ | 65/80 [00:02<00:00, 31.29it/s] 86%|████████▋ | 69/80 [00:02<00:00, 31.02it/s] 91%|█████████▏| 73/80 [00:02<00:00, 30.73it/s] 96%|█████████▋| 77/80 [00:02<00:00, 30.45it/s]100%|██████████| 80/80 [00:02<00:00, 27.84it/s]
Cached Size: 8000 | Max Budget: 9200
0.02772001540660858 1 8000 2000
0.02811277222633362 2 8000 2000
0.02821368408203125 4 8000 2000
0.028419315934181212 8 8000 2000
0.028765862464904784 16 8000 2000
0.02969769501686096 32 8000 2000
0.032226822018623355 64 8000 2000
0.03400304651260376 128 8000 2000
0.0472981219291687 256 8000 2000
0.08474340546131134 512 8000 2000
0.15397915601730347 1024 8000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.92s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.43s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:06,  3.66it/s]Resolving data files:  26%|██▌       | 6/23 [00:00<00:01, 14.54it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 40.61it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:09<00:00,  9.06s/it]100%|██████████| 1/1 [00:09<00:00,  9.06s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.08s/it]100%|██████████| 1/1 [00:11<00:00, 11.08s/it]
  0%|          | 0/160 [00:00<?, ?it/s]  1%|          | 1/160 [00:00<01:05,  2.43it/s]  3%|▎         | 5/160 [00:00<00:13, 11.39it/s]  6%|▌         | 9/160 [00:00<00:08, 17.76it/s]  8%|▊         | 13/160 [00:00<00:06, 22.25it/s] 11%|█         | 17/160 [00:00<00:05, 25.39it/s] 13%|█▎        | 21/160 [00:01<00:05, 27.42it/s] 16%|█▌        | 25/160 [00:01<00:04, 28.99it/s] 18%|█▊        | 29/160 [00:01<00:04, 30.11it/s] 21%|██        | 33/160 [00:01<00:04, 30.91it/s] 23%|██▎       | 37/160 [00:01<00:03, 31.45it/s] 26%|██▌       | 41/160 [00:01<00:03, 31.72it/s] 28%|██▊       | 45/160 [00:01<00:03, 31.82it/s] 31%|███       | 49/160 [00:01<00:03, 31.82it/s] 33%|███▎      | 53/160 [00:02<00:03, 31.72it/s] 36%|███▌      | 57/160 [00:02<00:03, 31.55it/s] 38%|███▊      | 61/160 [00:02<00:03, 31.35it/s] 41%|████      | 65/160 [00:02<00:03, 31.10it/s] 43%|████▎     | 69/160 [00:02<00:02, 30.84it/s] 46%|████▌     | 73/160 [00:02<00:02, 30.57it/s] 48%|████▊     | 77/160 [00:02<00:02, 30.30it/s] 51%|█████     | 81/160 [00:02<00:02, 30.03it/s] 53%|█████▎    | 85/160 [00:03<00:02, 29.78it/s] 55%|█████▌    | 88/160 [00:03<00:02, 29.59it/s] 57%|█████▋    | 91/160 [00:03<00:02, 29.39it/s] 59%|█████▉    | 94/160 [00:03<00:02, 29.18it/s] 61%|██████    | 97/160 [00:03<00:02, 28.97it/s] 62%|██████▎   | 100/160 [00:03<00:02, 28.74it/s] 64%|██████▍   | 103/160 [00:03<00:01, 28.54it/s] 66%|██████▋   | 106/160 [00:03<00:01, 28.33it/s] 68%|██████▊   | 109/160 [00:03<00:01, 28.12it/s] 70%|███████   | 112/160 [00:04<00:01, 27.93it/s] 72%|███████▏  | 115/160 [00:04<00:01, 27.73it/s] 74%|███████▍  | 118/160 [00:04<00:01, 27.54it/s] 76%|███████▌  | 121/160 [00:04<00:01, 27.27it/s] 78%|███████▊  | 124/160 [00:04<00:01, 27.10it/s] 79%|███████▉  | 127/160 [00:04<00:01, 26.95it/s] 81%|████████▏ | 130/160 [00:04<00:01, 26.79it/s] 83%|████████▎ | 133/160 [00:04<00:01, 26.63it/s] 85%|████████▌ | 136/160 [00:04<00:00, 26.46it/s] 87%|████████▋ | 139/160 [00:05<00:00, 26.28it/s] 89%|████████▉ | 142/160 [00:05<00:00, 26.10it/s] 91%|█████████ | 145/160 [00:05<00:00, 25.94it/s] 92%|█████████▎| 148/160 [00:05<00:00, 25.77it/s] 94%|█████████▍| 151/160 [00:05<00:00, 25.62it/s] 96%|█████████▋| 154/160 [00:05<00:00, 25.46it/s] 98%|█████████▊| 157/160 [00:05<00:00, 25.29it/s]100%|██████████| 160/160 [00:05<00:00, 25.15it/s]100%|██████████| 160/160 [00:05<00:00, 27.19it/s]
Cached Size: 16000 | Max Budget: 17200
0.03346691918373108 1 16000 2000
0.033823345422744754 2 16000 2000
0.033929131150245664 4 16000 2000
0.034152283787727354 8 16000 2000
0.03446577906608581 16 16000 2000
0.03538376700878143 32 16000 2000
0.03736815905570984 64 16000 2000
0.03989576816558838 128 16000 2000
0.059245892405509946 256 16000 2000
0.10600729703903199 512 16000 2000
0.19171545696258546 1024 16000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.07s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.29s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.85s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:09,  2.28it/s]Resolving data files:  22%|██▏       | 5/23 [00:00<00:01, 10.81it/s]Resolving data files:  83%|████████▎ | 19/23 [00:00<00:00, 37.39it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 31.74it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:09<00:00,  9.23s/it]100%|██████████| 1/1 [00:09<00:00,  9.23s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.81s/it]100%|██████████| 1/1 [00:11<00:00, 11.81s/it]
  0%|          | 0/320 [00:00<?, ?it/s]  0%|          | 1/320 [00:00<02:18,  2.31it/s]  2%|▏         | 5/320 [00:00<00:28, 10.99it/s]  3%|▎         | 9/320 [00:00<00:17, 17.29it/s]  4%|▍         | 13/320 [00:00<00:14, 21.81it/s]  5%|▌         | 17/320 [00:00<00:12, 24.98it/s]  7%|▋         | 21/320 [00:01<00:11, 27.03it/s]  8%|▊         | 25/320 [00:01<00:10, 27.29it/s]  9%|▉         | 29/320 [00:01<00:10, 28.82it/s] 10%|█         | 33/320 [00:01<00:09, 29.96it/s] 12%|█▏        | 37/320 [00:01<00:09, 30.77it/s] 13%|█▎        | 41/320 [00:01<00:08, 31.29it/s] 14%|█▍        | 45/320 [00:01<00:08, 31.55it/s] 15%|█▌        | 49/320 [00:01<00:08, 31.69it/s] 17%|█▋        | 53/320 [00:02<00:08, 31.68it/s] 18%|█▊        | 57/320 [00:02<00:08, 31.57it/s] 19%|█▉        | 61/320 [00:02<00:08, 31.40it/s] 20%|██        | 65/320 [00:02<00:08, 31.18it/s] 22%|██▏       | 69/320 [00:02<00:08, 30.93it/s] 23%|██▎       | 73/320 [00:02<00:08, 30.66it/s] 24%|██▍       | 77/320 [00:02<00:07, 30.40it/s] 25%|██▌       | 81/320 [00:02<00:07, 30.13it/s] 27%|██▋       | 85/320 [00:03<00:07, 29.82it/s] 28%|██▊       | 88/320 [00:03<00:07, 29.59it/s] 28%|██▊       | 91/320 [00:03<00:07, 29.36it/s] 29%|██▉       | 94/320 [00:03<00:07, 28.32it/s] 30%|███       | 97/320 [00:03<00:07, 28.29it/s] 31%|███▏      | 100/320 [00:03<00:07, 28.25it/s] 32%|███▏      | 103/320 [00:03<00:07, 28.18it/s] 33%|███▎      | 106/320 [00:03<00:07, 28.06it/s] 34%|███▍      | 109/320 [00:03<00:07, 27.93it/s] 35%|███▌      | 112/320 [00:04<00:07, 27.80it/s] 36%|███▌      | 115/320 [00:04<00:07, 27.62it/s] 37%|███▋      | 118/320 [00:04<00:07, 27.46it/s] 38%|███▊      | 121/320 [00:04<00:07, 27.30it/s] 39%|███▉      | 124/320 [00:04<00:07, 27.14it/s] 40%|███▉      | 127/320 [00:04<00:07, 26.98it/s] 41%|████      | 130/320 [00:04<00:07, 26.81it/s] 42%|████▏     | 133/320 [00:04<00:07, 26.61it/s] 42%|████▎     | 136/320 [00:04<00:06, 26.43it/s] 43%|████▎     | 139/320 [00:05<00:06, 26.23it/s] 44%|████▍     | 142/320 [00:05<00:06, 26.08it/s] 45%|████▌     | 145/320 [00:05<00:06, 25.91it/s] 46%|████▋     | 148/320 [00:05<00:06, 25.74it/s] 47%|████▋     | 151/320 [00:05<00:06, 25.58it/s] 48%|████▊     | 154/320 [00:05<00:06, 25.43it/s] 49%|████▉     | 157/320 [00:05<00:06, 25.28it/s] 50%|█████     | 160/320 [00:05<00:06, 25.11it/s] 51%|█████     | 163/320 [00:06<00:06, 24.97it/s] 52%|█████▏    | 166/320 [00:06<00:06, 24.82it/s] 53%|█████▎    | 169/320 [00:06<00:06, 24.67it/s] 54%|█████▍    | 172/320 [00:06<00:06, 24.53it/s] 55%|█████▍    | 175/320 [00:06<00:05, 24.39it/s] 56%|█████▌    | 178/320 [00:06<00:05, 24.24it/s] 57%|█████▋    | 181/320 [00:06<00:05, 24.11it/s] 57%|█████▊    | 184/320 [00:06<00:05, 23.97it/s] 58%|█████▊    | 187/320 [00:07<00:05, 23.84it/s] 59%|█████▉    | 190/320 [00:07<00:05, 23.70it/s] 60%|██████    | 193/320 [00:07<00:05, 23.57it/s] 61%|██████▏   | 196/320 [00:07<00:05, 23.44it/s] 62%|██████▏   | 199/320 [00:07<00:05, 23.30it/s] 63%|██████▎   | 202/320 [00:07<00:05, 23.16it/s] 64%|██████▍   | 205/320 [00:07<00:04, 23.03it/s] 65%|██████▌   | 208/320 [00:07<00:04, 22.91it/s] 66%|██████▌   | 211/320 [00:08<00:04, 22.78it/s] 67%|██████▋   | 214/320 [00:08<00:04, 22.65it/s] 68%|██████▊   | 217/320 [00:08<00:04, 22.54it/s] 69%|██████▉   | 220/320 [00:08<00:04, 22.42it/s] 70%|██████▉   | 223/320 [00:08<00:04, 22.32it/s] 71%|███████   | 226/320 [00:08<00:04, 22.20it/s] 72%|███████▏  | 229/320 [00:08<00:04, 22.09it/s] 72%|███████▎  | 232/320 [00:09<00:04, 21.90it/s] 73%|███████▎  | 235/320 [00:09<00:03, 21.83it/s] 74%|███████▍  | 238/320 [00:09<00:03, 21.71it/s] 75%|███████▌  | 241/320 [00:09<00:03, 21.60it/s] 76%|███████▋  | 244/320 [00:09<00:03, 21.49it/s] 77%|███████▋  | 247/320 [00:09<00:03, 21.37it/s] 78%|███████▊  | 250/320 [00:09<00:03, 21.11it/s] 79%|███████▉  | 253/320 [00:10<00:03, 21.05it/s] 80%|████████  | 256/320 [00:10<00:03, 20.98it/s] 81%|████████  | 259/320 [00:10<00:02, 20.90it/s] 82%|████████▏ | 262/320 [00:10<00:02, 20.83it/s] 83%|████████▎ | 265/320 [00:10<00:02, 20.76it/s] 84%|████████▍ | 268/320 [00:10<00:02, 20.61it/s] 85%|████████▍ | 271/320 [00:10<00:02, 20.51it/s] 86%|████████▌ | 274/320 [00:11<00:02, 20.43it/s] 87%|████████▋ | 277/320 [00:11<00:02, 20.36it/s] 88%|████████▊ | 280/320 [00:11<00:01, 20.25it/s] 88%|████████▊ | 283/320 [00:11<00:01, 20.16it/s] 89%|████████▉ | 286/320 [00:11<00:01, 20.07it/s] 90%|█████████ | 289/320 [00:11<00:01, 19.96it/s] 91%|█████████ | 291/320 [00:11<00:01, 19.90it/s] 92%|█████████▏| 293/320 [00:12<00:01, 19.83it/s] 92%|█████████▏| 295/320 [00:12<00:01, 19.75it/s] 93%|█████████▎| 297/320 [00:12<00:01, 19.68it/s] 93%|█████████▎| 299/320 [00:12<00:01, 19.60it/s] 94%|█████████▍| 301/320 [00:12<00:00, 19.52it/s] 95%|█████████▍| 303/320 [00:12<00:00, 19.45it/s] 95%|█████████▌| 305/320 [00:12<00:00, 19.40it/s] 96%|█████████▌| 307/320 [00:12<00:00, 19.35it/s] 97%|█████████▋| 309/320 [00:12<00:00, 19.27it/s] 97%|█████████▋| 311/320 [00:12<00:00, 19.21it/s] 98%|█████████▊| 313/320 [00:13<00:00, 19.15it/s] 98%|█████████▊| 315/320 [00:13<00:00, 19.09it/s] 99%|█████████▉| 317/320 [00:13<00:00, 19.03it/s]100%|█████████▉| 319/320 [00:13<00:00, 18.96it/s]100%|██████████| 320/320 [00:13<00:00, 23.80it/s]
Cached Size: 32000 | Max Budget: 33200
0.044994840502738956 1 32000 2000
0.04533908224105835 2 32000 2000
0.04552967977523804 4 32000 2000
0.0456689578294754 8 32000 2000
0.04601189732551575 16 32000 2000
0.04705868661403656 32 32000 2000
0.04881293451786041 64 32000 2000
0.05173132348060608 128 32000 2000
0.08267666518688202 256 32000 2000
0.14820304358005523 512 32000 2000
0.27256080508232117 1024 32000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.94s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.33s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:11,  1.89it/s]Resolving data files:   9%|▊         | 2/23 [00:00<00:06,  3.41it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 31.80it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.84s/it]100%|██████████| 1/1 [00:08<00:00,  8.84s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.25s/it]100%|██████████| 1/1 [00:11<00:00, 11.25s/it]
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:00<03:27,  2.40it/s]  1%|          | 5/500 [00:00<00:43, 11.28it/s]  2%|▏         | 9/500 [00:00<00:27, 17.56it/s]  3%|▎         | 13/500 [00:00<00:22, 22.01it/s]  3%|▎         | 17/500 [00:00<00:19, 24.59it/s]  4%|▍         | 20/500 [00:01<00:19, 25.21it/s]  5%|▍         | 24/500 [00:01<00:17, 27.18it/s]  6%|▌         | 28/500 [00:01<00:16, 28.74it/s]  6%|▋         | 32/500 [00:01<00:15, 29.85it/s]  7%|▋         | 36/500 [00:01<00:15, 30.63it/s]  8%|▊         | 40/500 [00:01<00:14, 31.22it/s]  9%|▉         | 44/500 [00:01<00:14, 31.56it/s] 10%|▉         | 48/500 [00:01<00:14, 31.72it/s] 10%|█         | 52/500 [00:02<00:14, 31.74it/s] 11%|█         | 56/500 [00:02<00:14, 30.80it/s] 12%|█▏        | 60/500 [00:02<00:14, 30.73it/s] 13%|█▎        | 64/500 [00:02<00:14, 30.74it/s] 14%|█▎        | 68/500 [00:02<00:14, 30.66it/s] 14%|█▍        | 72/500 [00:02<00:14, 30.51it/s] 15%|█▌        | 76/500 [00:02<00:13, 30.32it/s] 16%|█▌        | 80/500 [00:02<00:13, 30.10it/s] 17%|█▋        | 84/500 [00:03<00:13, 29.81it/s] 17%|█▋        | 87/500 [00:03<00:13, 29.62it/s] 18%|█▊        | 90/500 [00:03<00:13, 29.41it/s] 19%|█▊        | 93/500 [00:03<00:13, 29.20it/s] 19%|█▉        | 96/500 [00:03<00:13, 28.98it/s] 20%|█▉        | 99/500 [00:03<00:13, 28.78it/s] 20%|██        | 102/500 [00:03<00:13, 28.57it/s] 21%|██        | 105/500 [00:03<00:13, 28.37it/s] 22%|██▏       | 108/500 [00:03<00:13, 28.17it/s] 22%|██▏       | 111/500 [00:04<00:13, 27.95it/s] 23%|██▎       | 114/500 [00:04<00:13, 27.79it/s] 23%|██▎       | 117/500 [00:04<00:13, 27.61it/s] 24%|██▍       | 120/500 [00:04<00:13, 27.41it/s] 25%|██▍       | 123/500 [00:04<00:13, 27.26it/s] 25%|██▌       | 126/500 [00:04<00:13, 27.08it/s] 26%|██▌       | 129/500 [00:04<00:13, 26.91it/s] 26%|██▋       | 132/500 [00:04<00:13, 26.71it/s] 27%|██▋       | 135/500 [00:04<00:13, 26.52it/s] 28%|██▊       | 138/500 [00:05<00:13, 26.32it/s] 28%|██▊       | 141/500 [00:05<00:13, 26.17it/s] 29%|██▉       | 144/500 [00:05<00:13, 26.00it/s] 29%|██▉       | 147/500 [00:05<00:13, 25.80it/s] 30%|███       | 150/500 [00:05<00:13, 25.66it/s] 31%|███       | 153/500 [00:05<00:13, 25.49it/s] 31%|███       | 156/500 [00:05<00:13, 25.36it/s] 32%|███▏      | 159/500 [00:05<00:13, 25.21it/s] 32%|███▏      | 162/500 [00:06<00:13, 25.05it/s] 33%|███▎      | 165/500 [00:06<00:13, 24.89it/s] 34%|███▎      | 168/500 [00:06<00:13, 24.75it/s] 34%|███▍      | 171/500 [00:06<00:13, 24.60it/s] 35%|███▍      | 174/500 [00:06<00:13, 24.45it/s] 35%|███▌      | 177/500 [00:06<00:13, 24.31it/s] 36%|███▌      | 180/500 [00:06<00:13, 24.17it/s] 37%|███▋      | 183/500 [00:06<00:13, 24.04it/s] 37%|███▋      | 186/500 [00:07<00:13, 23.91it/s] 38%|███▊      | 189/500 [00:07<00:13, 23.77it/s] 38%|███▊      | 192/500 [00:07<00:13, 23.64it/s] 39%|███▉      | 195/500 [00:07<00:12, 23.51it/s] 40%|███▉      | 198/500 [00:07<00:12, 23.37it/s] 40%|████      | 201/500 [00:07<00:12, 23.23it/s] 41%|████      | 204/500 [00:07<00:12, 23.10it/s] 41%|████▏     | 207/500 [00:07<00:12, 22.97it/s] 42%|████▏     | 210/500 [00:08<00:12, 22.84it/s] 43%|████▎     | 213/500 [00:08<00:12, 22.72it/s] 43%|████▎     | 216/500 [00:08<00:12, 22.60it/s] 44%|████▍     | 219/500 [00:08<00:12, 22.50it/s] 44%|████▍     | 222/500 [00:08<00:12, 22.39it/s] 45%|████▌     | 225/500 [00:08<00:12, 22.27it/s] 46%|████▌     | 228/500 [00:08<00:12, 22.14it/s] 46%|████▌     | 231/500 [00:09<00:12, 22.04it/s] 47%|████▋     | 234/500 [00:09<00:12, 21.92it/s] 47%|████▋     | 237/500 [00:09<00:12, 21.81it/s] 48%|████▊     | 240/500 [00:09<00:11, 21.69it/s] 49%|████▊     | 243/500 [00:09<00:11, 21.57it/s] 49%|████▉     | 246/500 [00:09<00:11, 21.46it/s] 50%|████▉     | 249/500 [00:09<00:11, 21.34it/s] 50%|█████     | 252/500 [00:09<00:11, 21.23it/s] 51%|█████     | 255/500 [00:10<00:11, 21.11it/s] 52%|█████▏    | 258/500 [00:10<00:11, 21.01it/s] 52%|█████▏    | 261/500 [00:10<00:11, 20.92it/s] 53%|█████▎    | 264/500 [00:10<00:11, 20.83it/s] 53%|█████▎    | 267/500 [00:10<00:11, 20.73it/s] 54%|█████▍    | 270/500 [00:10<00:11, 20.64it/s] 55%|█████▍    | 273/500 [00:11<00:11, 20.54it/s] 55%|█████▌    | 276/500 [00:11<00:10, 20.44it/s] 56%|█████▌    | 279/500 [00:11<00:10, 20.32it/s] 56%|█████▋    | 282/500 [00:11<00:10, 20.21it/s] 57%|█████▋    | 285/500 [00:11<00:10, 20.11it/s] 58%|█████▊    | 288/500 [00:11<00:10, 20.01it/s] 58%|█████▊    | 291/500 [00:11<00:10, 19.92it/s] 59%|█████▊    | 293/500 [00:12<00:10, 19.85it/s] 59%|█████▉    | 295/500 [00:12<00:10, 19.77it/s] 59%|█████▉    | 297/500 [00:12<00:10, 19.69it/s] 60%|█████▉    | 299/500 [00:12<00:10, 19.62it/s] 60%|██████    | 301/500 [00:12<00:10, 19.54it/s] 61%|██████    | 303/500 [00:12<00:10, 19.47it/s] 61%|██████    | 305/500 [00:12<00:10, 19.42it/s] 61%|██████▏   | 307/500 [00:12<00:09, 19.35it/s] 62%|██████▏   | 309/500 [00:12<00:09, 19.30it/s] 62%|██████▏   | 311/500 [00:12<00:09, 19.21it/s] 63%|██████▎   | 313/500 [00:13<00:09, 19.16it/s] 63%|██████▎   | 315/500 [00:13<00:09, 19.10it/s] 63%|██████▎   | 317/500 [00:13<00:09, 19.05it/s] 64%|██████▍   | 319/500 [00:13<00:09, 18.98it/s] 64%|██████▍   | 321/500 [00:13<00:09, 18.91it/s] 65%|██████▍   | 323/500 [00:13<00:09, 18.88it/s] 65%|██████▌   | 325/500 [00:13<00:09, 18.83it/s] 65%|██████▌   | 327/500 [00:13<00:09, 18.76it/s] 66%|██████▌   | 329/500 [00:13<00:09, 18.67it/s] 66%|██████▌   | 331/500 [00:14<00:09, 18.61it/s] 67%|██████▋   | 333/500 [00:14<00:08, 18.56it/s] 67%|██████▋   | 335/500 [00:14<00:08, 18.50it/s] 67%|██████▋   | 337/500 [00:14<00:08, 18.45it/s] 68%|██████▊   | 339/500 [00:14<00:08, 18.39it/s] 68%|██████▊   | 341/500 [00:14<00:08, 18.35it/s] 69%|██████▊   | 343/500 [00:14<00:08, 18.32it/s] 69%|██████▉   | 345/500 [00:14<00:08, 18.29it/s] 69%|██████▉   | 347/500 [00:14<00:08, 18.24it/s] 70%|██████▉   | 349/500 [00:15<00:08, 18.17it/s] 70%|███████   | 351/500 [00:15<00:08, 18.12it/s] 71%|███████   | 353/500 [00:15<00:08, 18.07it/s] 71%|███████   | 355/500 [00:15<00:08, 18.01it/s] 71%|███████▏  | 357/500 [00:15<00:07, 17.96it/s] 72%|███████▏  | 359/500 [00:15<00:07, 17.91it/s] 72%|███████▏  | 361/500 [00:15<00:07, 17.86it/s] 73%|███████▎  | 363/500 [00:15<00:07, 17.81it/s] 73%|███████▎  | 365/500 [00:15<00:07, 17.76it/s] 73%|███████▎  | 367/500 [00:16<00:07, 17.70it/s] 74%|███████▍  | 369/500 [00:16<00:07, 17.63it/s] 74%|███████▍  | 371/500 [00:16<00:07, 17.57it/s] 75%|███████▍  | 373/500 [00:16<00:07, 17.52it/s] 75%|███████▌  | 375/500 [00:16<00:07, 17.48it/s] 75%|███████▌  | 377/500 [00:16<00:07, 17.42it/s] 76%|███████▌  | 379/500 [00:16<00:06, 17.38it/s] 76%|███████▌  | 381/500 [00:16<00:06, 17.35it/s] 77%|███████▋  | 383/500 [00:16<00:06, 17.30it/s] 77%|███████▋  | 385/500 [00:17<00:06, 17.26it/s] 77%|███████▋  | 387/500 [00:17<00:06, 17.21it/s] 78%|███████▊  | 389/500 [00:17<00:06, 17.16it/s] 78%|███████▊  | 391/500 [00:17<00:06, 17.11it/s] 79%|███████▊  | 393/500 [00:17<00:06, 17.07it/s] 79%|███████▉  | 395/500 [00:17<00:06, 17.01it/s] 79%|███████▉  | 397/500 [00:17<00:06, 16.97it/s] 80%|███████▉  | 399/500 [00:17<00:05, 16.93it/s] 80%|████████  | 401/500 [00:17<00:05, 16.88it/s] 81%|████████  | 403/500 [00:18<00:05, 16.84it/s] 81%|████████  | 405/500 [00:18<00:05, 16.79it/s] 81%|████████▏ | 407/500 [00:18<00:05, 16.75it/s] 82%|████████▏ | 409/500 [00:18<00:05, 16.70it/s] 82%|████████▏ | 411/500 [00:18<00:05, 16.65it/s] 83%|████████▎ | 413/500 [00:18<00:05, 16.61it/s] 83%|████████▎ | 415/500 [00:18<00:05, 16.57it/s] 83%|████████▎ | 417/500 [00:18<00:05, 16.52it/s] 84%|████████▍ | 419/500 [00:19<00:04, 16.48it/s] 84%|████████▍ | 421/500 [00:19<00:04, 16.44it/s] 85%|████████▍ | 423/500 [00:19<00:04, 16.40it/s] 85%|████████▌ | 425/500 [00:19<00:04, 16.35it/s] 85%|████████▌ | 427/500 [00:19<00:04, 16.31it/s] 86%|████████▌ | 429/500 [00:19<00:04, 16.28it/s] 86%|████████▌ | 431/500 [00:19<00:04, 16.26it/s] 87%|████████▋ | 433/500 [00:19<00:04, 16.22it/s] 87%|████████▋ | 435/500 [00:20<00:04, 16.18it/s] 87%|████████▋ | 437/500 [00:20<00:03, 16.14it/s] 88%|████████▊ | 439/500 [00:20<00:03, 16.11it/s] 88%|████████▊ | 441/500 [00:20<00:03, 16.07it/s] 89%|████████▊ | 443/500 [00:20<00:03, 16.03it/s] 89%|████████▉ | 445/500 [00:20<00:03, 15.99it/s] 89%|████████▉ | 447/500 [00:20<00:03, 15.95it/s] 90%|████████▉ | 449/500 [00:20<00:03, 15.90it/s] 90%|█████████ | 451/500 [00:21<00:03, 15.85it/s] 91%|█████████ | 453/500 [00:21<00:02, 15.82it/s] 91%|█████████ | 455/500 [00:21<00:02, 15.79it/s] 91%|█████████▏| 457/500 [00:21<00:02, 15.74it/s] 92%|█████████▏| 459/500 [00:21<00:02, 15.70it/s] 92%|█████████▏| 461/500 [00:21<00:02, 15.66it/s] 93%|█████████▎| 463/500 [00:21<00:02, 15.62it/s] 93%|█████████▎| 465/500 [00:21<00:02, 15.58it/s] 93%|█████████▎| 467/500 [00:22<00:02, 15.55it/s] 94%|█████████▍| 469/500 [00:22<00:01, 15.51it/s] 94%|█████████▍| 471/500 [00:22<00:01, 15.47it/s] 95%|█████████▍| 473/500 [00:22<00:01, 15.43it/s] 95%|█████████▌| 475/500 [00:22<00:01, 15.38it/s] 95%|█████████▌| 477/500 [00:22<00:01, 15.35it/s] 96%|█████████▌| 479/500 [00:22<00:01, 15.31it/s] 96%|█████████▌| 481/500 [00:23<00:01, 15.27it/s] 97%|█████████▋| 483/500 [00:23<00:01, 15.23it/s] 97%|█████████▋| 485/500 [00:23<00:00, 15.19it/s] 97%|█████████▋| 487/500 [00:23<00:00, 15.16it/s] 98%|█████████▊| 489/500 [00:23<00:00, 15.12it/s] 98%|█████████▊| 491/500 [00:23<00:00, 15.09it/s] 99%|█████████▊| 493/500 [00:23<00:00, 15.05it/s] 99%|█████████▉| 495/500 [00:23<00:00, 15.02it/s] 99%|█████████▉| 497/500 [00:24<00:00, 14.98it/s]100%|█████████▉| 499/500 [00:24<00:00, 14.95it/s]100%|██████████| 500/500 [00:24<00:00, 20.59it/s]
Cached Size: 50000 | Max Budget: 51200
0.057965847730636594 1 50000 2000
0.05836258244514465 2 50000 2000
0.05842039322853088 4 50000 2000
0.05863491415977478 8 50000 2000
0.058977063298225406 16 50000 2000
0.05983247137069702 32 50000 2000
0.061856390595436093 64 50000 2000
0.06475622439384461 128 50000 2000
0.10901404547691346 256 50000 2000
0.1954651905298233 512 50000 2000
0.3616425144672394 1024 50000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:10<00:10, 10.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.25s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:07,  2.77it/s]Resolving data files:  39%|███▉      | 9/23 [00:00<00:00, 18.26it/s]Resolving data files:  87%|████████▋ | 20/23 [00:00<00:00, 30.94it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 28.61it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.94s/it]100%|██████████| 1/1 [00:08<00:00,  8.94s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.47s/it]100%|██████████| 1/1 [00:11<00:00, 11.47s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.15it/s]100%|██████████| 1/1 [00:00<00:00,  2.15it/s]
0.02656116807460785 1 1 2000
0.026636717319488527 2 1 2000
0.02660193359851837 4 1 2000
0.02681784737110138 8 1 2000
0.026737804532051088 16 1 2000
0.02760093867778778 32 1 2000
0.029202683091163636 64 1 2000
0.03184005928039551 128 1 2000
0.03651267099380493 256 1 2000
0.06376032698154449 512 1 2000
0.11633135414123535 1024 1 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.63s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:12,  1.83it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 35.55it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.84s/it]100%|██████████| 1/1 [00:08<00:00,  8.84s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.40s/it]100%|██████████| 1/1 [00:11<00:00, 11.40s/it]
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:04,  2.12it/s] 40%|████      | 4/10 [00:00<00:00,  8.56it/s] 70%|███████   | 7/10 [00:00<00:00, 13.73it/s]100%|██████████| 10/10 [00:00<00:00, 17.72it/s]100%|██████████| 10/10 [00:00<00:00, 12.76it/s]
0.02702283811569214 1 1000 2000
0.02793737757205963 2 1000 2000
0.02760873854160309 4 1000 2000
0.028167238235473634 8 1000 2000
0.028438005208969115 16 1000 2000
0.02888814854621887 32 1000 2000
0.03094873547554016 64 1000 2000
0.03330340552330017 128 1000 2000
0.037649517178535465 256 1000 2000
0.06668304443359375 512 1000 2000
0.12120144200325013 1024 1000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.30s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.79s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:08,  2.68it/s]Resolving data files:  13%|█▎        | 3/23 [00:00<00:03,  5.76it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 47.17it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 32.08it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:09<00:00,  9.44s/it]100%|██████████| 1/1 [00:09<00:00,  9.44s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:12<00:00, 12.07s/it]100%|██████████| 1/1 [00:12<00:00, 12.07s/it]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:08,  2.14it/s] 20%|██        | 4/20 [00:00<00:01,  8.63it/s] 35%|███▌      | 7/20 [00:00<00:00, 13.90it/s] 50%|█████     | 10/20 [00:00<00:00, 17.87it/s] 65%|██████▌   | 13/20 [00:00<00:00, 20.61it/s] 80%|████████  | 16/20 [00:01<00:00, 22.30it/s] 95%|█████████▌| 19/20 [00:01<00:00, 23.19it/s]100%|██████████| 20/20 [00:01<00:00, 17.27it/s]
0.027918310046195983 1 2000 2000
0.02899397099018097 2 2000 2000
0.02904150581359863 4 2000 2000
0.029197451114654542 8 2000 2000
0.029450868725776673 16 2000 2000
0.030203431725502015 32 2000 2000
0.03243516409397125 64 2000 2000
0.0341807804107666 128 2000 2000
0.04053735148906708 256 2000 2000
0.06951919794082642 512 2000 2000
0.1262099598646164 1024 2000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.58s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:10,  2.15it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 43.88it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.73s/it]100%|██████████| 1/1 [00:08<00:00,  8.73s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.14s/it]100%|██████████| 1/1 [00:11<00:00, 11.14s/it]
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.20it/s] 10%|█         | 4/40 [00:00<00:04,  8.83it/s] 18%|█▊        | 7/40 [00:00<00:02, 14.18it/s] 25%|██▌       | 10/40 [00:00<00:01, 18.19it/s] 32%|███▎      | 13/40 [00:00<00:01, 20.81it/s] 40%|████      | 16/40 [00:00<00:01, 22.59it/s] 48%|████▊     | 19/40 [00:01<00:00, 23.75it/s] 55%|█████▌    | 22/40 [00:01<00:00, 24.55it/s] 62%|██████▎   | 25/40 [00:01<00:00, 25.13it/s] 70%|███████   | 28/40 [00:01<00:00, 25.34it/s] 78%|███████▊  | 31/40 [00:01<00:00, 25.58it/s] 85%|████████▌ | 34/40 [00:01<00:00, 25.66it/s] 92%|█████████▎| 37/40 [00:02<00:00,  9.70it/s]100%|██████████| 40/40 [00:02<00:00, 11.96it/s]100%|██████████| 40/40 [00:02<00:00, 15.77it/s]
0.031356906056404114 1 4000 2000
0.0318336193561554 2 4000 2000
0.03169600319862366 4 4000 2000
0.03177184236049652 8 4000 2000
0.032015551686286926 16 4000 2000
0.032784865617752075 32 4000 2000
0.03471846568584442 64 4000 2000
0.03655126368999481 128 4000 2000
0.04710553920269012 256 4000 2000
0.07591507470607757 512 4000 2000
0.13736240267753602 1024 4000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:17<00:17, 17.78s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00,  8.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:20<00:00, 10.09s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:13,  1.61it/s]Resolving data files:  43%|████▎     | 10/23 [00:00<00:00, 17.84it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 30.65it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.68s/it]100%|██████████| 1/1 [00:08<00:00,  8.68s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.05s/it]100%|██████████| 1/1 [00:11<00:00, 11.05s/it]
  0%|          | 0/80 [00:00<?, ?it/s]  1%|▏         | 1/80 [00:00<00:35,  2.21it/s]  5%|▌         | 4/80 [00:00<00:08,  8.87it/s]  9%|▉         | 7/80 [00:00<00:05, 14.21it/s] 12%|█▎        | 10/80 [00:00<00:03, 18.21it/s] 16%|█▋        | 13/80 [00:00<00:03, 20.89it/s] 20%|██        | 16/80 [00:00<00:02, 22.69it/s] 24%|██▍       | 19/80 [00:01<00:02, 23.91it/s] 28%|██▊       | 22/80 [00:01<00:02, 24.72it/s] 31%|███▏      | 25/80 [00:01<00:02, 25.16it/s] 35%|███▌      | 28/80 [00:01<00:02, 25.25it/s] 39%|███▉      | 31/80 [00:01<00:01, 25.35it/s] 42%|████▎     | 34/80 [00:01<00:01, 25.24it/s] 46%|████▋     | 37/80 [00:02<00:04,  9.67it/s] 50%|█████     | 40/80 [00:02<00:03, 11.92it/s] 54%|█████▍    | 43/80 [00:02<00:02, 14.19it/s] 57%|█████▊    | 46/80 [00:02<00:02, 16.27it/s] 61%|██████▏   | 49/80 [00:03<00:03,  9.51it/s] 65%|██████▌   | 52/80 [00:03<00:02, 11.43it/s] 69%|██████▉   | 55/80 [00:03<00:01, 13.56it/s] 72%|███████▎  | 58/80 [00:03<00:01, 15.50it/s] 76%|███████▋  | 61/80 [00:04<00:01,  9.77it/s] 80%|████████  | 64/80 [00:04<00:01, 11.84it/s] 84%|████████▍ | 67/80 [00:04<00:00, 13.79it/s] 86%|████████▋ | 69/80 [00:05<00:01,  8.92it/s] 89%|████████▉ | 71/80 [00:05<00:00, 10.10it/s] 92%|█████████▎| 74/80 [00:05<00:00, 12.40it/s] 95%|█████████▌| 76/80 [00:05<00:00,  9.08it/s] 98%|█████████▊| 78/80 [00:05<00:00,  9.98it/s]100%|██████████| 80/80 [00:06<00:00, 13.29it/s]
0.038579269647598266 1 8000 2000
0.03806915271282196 2 8000 2000
0.03816945469379425 4 8000 2000
0.038375149726867674 8 8000 2000
0.03879331493377686 16 8000 2000
0.039608126759529114 32 8000 2000
0.04173781478404999 64 8000 2000
0.04461823749542236 128 8000 2000
0.05907488739490509 256 8000 2000
0.08812993824481964 512 8000 2000
0.15765533876419066 1024 8000 2000
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:12<00:12, 12.26s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  6.65s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  7.49s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:08,  2.65it/s]Resolving data files:  22%|██▏       | 5/23 [00:00<00:01, 10.52it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 37.65it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.42s/it]100%|██████████| 1/1 [00:08<00:00,  8.42s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:10<00:00, 10.73s/it]100%|██████████| 1/1 [00:10<00:00, 10.74s/it]
  0%|          | 0/160 [00:00<?, ?it/s]  1%|          | 1/160 [00:00<01:14,  2.12it/s]  2%|▎         | 4/160 [00:00<00:18,  8.61it/s]  4%|▍         | 7/160 [00:00<00:11, 13.89it/s]  6%|▋         | 10/160 [00:00<00:08, 17.95it/s]  8%|▊         | 13/160 [00:00<00:07, 20.81it/s] 10%|█         | 16/160 [00:00<00:06, 22.61it/s] 12%|█▏        | 19/160 [00:01<00:05, 23.77it/s] 14%|█▍        | 22/160 [00:01<00:05, 24.66it/s] 16%|█▌        | 25/160 [00:01<00:05, 25.18it/s] 18%|█▊        | 28/160 [00:01<00:05, 25.53it/s] 19%|█▉        | 31/160 [00:01<00:04, 25.80it/s] 21%|██▏       | 34/160 [00:01<00:04, 25.89it/s] 23%|██▎       | 37/160 [00:02<00:12,  9.75it/s] 25%|██▌       | 40/160 [00:02<00:09, 12.05it/s] 27%|██▋       | 43/160 [00:02<00:08, 14.37it/s] 29%|██▉       | 46/160 [00:02<00:06, 16.56it/s] 31%|███       | 49/160 [00:03<00:11,  9.56it/s] 32%|███▎      | 52/160 [00:03<00:09, 11.54it/s] 34%|███▍      | 55/160 [00:03<00:07, 13.73it/s] 36%|███▋      | 58/160 [00:03<00:06, 15.79it/s] 38%|███▊      | 61/160 [00:04<00:10,  9.87it/s] 40%|████      | 64/160 [00:04<00:08, 11.97it/s] 42%|████▏     | 67/160 [00:04<00:06, 13.95it/s] 44%|████▍     | 70/160 [00:05<00:09,  9.29it/s] 46%|████▌     | 73/160 [00:05<00:07, 11.28it/s] 47%|████▋     | 75/160 [00:05<00:09,  9.04it/s] 48%|████▊     | 77/160 [00:05<00:08,  9.86it/s] 49%|████▉     | 79/160 [00:05<00:07, 11.05it/s] 51%|█████▏    | 82/160 [00:06<00:08,  8.88it/s] 52%|█████▎    | 84/160 [00:06<00:07,  9.68it/s] 54%|█████▍    | 86/160 [00:06<00:06, 11.05it/s] 55%|█████▌    | 88/160 [00:07<00:08,  8.37it/s] 56%|█████▋    | 90/160 [00:07<00:07,  9.29it/s] 57%|█████▊    | 92/160 [00:07<00:06, 10.98it/s] 59%|█████▉    | 94/160 [00:07<00:07,  8.45it/s] 60%|██████    | 96/160 [00:07<00:06,  9.37it/s] 61%|██████▏   | 98/160 [00:08<00:08,  7.64it/s] 62%|██████▎   | 100/160 [00:08<00:06,  8.67it/s] 64%|██████▍   | 102/160 [00:08<00:06,  9.46it/s] 65%|██████▌   | 104/160 [00:08<00:07,  7.65it/s] 66%|██████▌   | 105/160 [00:09<00:07,  7.63it/s] 67%|██████▋   | 107/160 [00:09<00:05,  9.08it/s] 68%|██████▊   | 109/160 [00:09<00:07,  7.14it/s] 69%|██████▉   | 110/160 [00:09<00:06,  7.20it/s] 70%|███████   | 112/160 [00:10<00:07,  6.82it/s] 71%|███████   | 113/160 [00:10<00:06,  6.91it/s] 71%|███████▏  | 114/160 [00:10<00:06,  7.03it/s] 72%|███████▎  | 116/160 [00:10<00:06,  6.34it/s] 73%|███████▎  | 117/160 [00:10<00:06,  6.51it/s] 74%|███████▍  | 119/160 [00:10<00:05,  8.13it/s] 75%|███████▌  | 120/160 [00:11<00:06,  5.73it/s] 76%|███████▋  | 122/160 [00:11<00:05,  7.28it/s] 77%|███████▋  | 123/160 [00:11<00:06,  5.65it/s] 78%|███████▊  | 124/160 [00:11<00:05,  6.06it/s] 79%|███████▉  | 126/160 [00:12<00:04,  7.56it/s] 79%|███████▉  | 127/160 [00:12<00:06,  5.38it/s] 81%|████████  | 129/160 [00:12<00:04,  6.73it/s] 81%|████████▏ | 130/160 [00:12<00:05,  5.96it/s] 82%|████████▏ | 131/160 [00:13<00:05,  5.58it/s] 83%|████████▎ | 133/160 [00:13<00:04,  6.07it/s] 84%|████████▍ | 134/160 [00:13<00:04,  5.89it/s] 85%|████████▌ | 136/160 [00:13<00:04,  5.48it/s] 86%|████████▌ | 137/160 [00:14<00:04,  5.64it/s] 87%|████████▋ | 139/160 [00:14<00:03,  5.96it/s] 88%|████████▊ | 140/160 [00:14<00:03,  5.76it/s] 89%|████████▉ | 142/160 [00:15<00:03,  5.28it/s] 89%|████████▉ | 143/160 [00:15<00:03,  5.55it/s] 91%|█████████ | 145/160 [00:15<00:02,  5.30it/s] 91%|█████████▏| 146/160 [00:15<00:02,  5.53it/s] 92%|█████████▎| 148/160 [00:16<00:02,  5.23it/s] 94%|█████████▍| 150/160 [00:16<00:01,  5.26it/s] 94%|█████████▍| 151/160 [00:16<00:01,  5.33it/s] 96%|█████████▌| 153/160 [00:17<00:01,  5.01it/s] 96%|█████████▋| 154/160 [00:17<00:01,  5.35it/s] 98%|█████████▊| 156/160 [00:17<00:00,  4.88it/s] 98%|█████████▊| 157/160 [00:17<00:00,  5.36it/s] 99%|█████████▉| 159/160 [00:18<00:00,  4.98it/s]100%|██████████| 160/160 [00:18<00:00,  5.31it/s]100%|██████████| 160/160 [00:18<00:00,  8.65it/s]
0.0573020521402359 1 16000 2000
0.057592383861541745 2 16000 2000
Traceback (most recent call last):
  File "/home/hanshis/workspace/LongContextInfer/benchmark_ori.py", line 54, in <module>
    outputs = model(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 984, in forward
    outputs = self.model(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 868, in forward
    layer_outputs = decoder_layer(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 619, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 528, in forward
    past_kv = torch.cat([past_kv, torch.empty(bsz, q.size(1), 2, kv.size(3), kv.size(4), dtype=kv.dtype, device=kv.device)], 1)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 252.00 MiB. GPU 0 has a total capacty of 44.32 GiB of which 31.81 MiB is free. Including non-PyTorch memory, this process has 44.28 GiB memory in use. Of the allocated memory 35.39 GiB is allocated by PyTorch, and 8.39 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.82s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.63s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.11s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:06,  3.16it/s]Resolving data files:  13%|█▎        | 3/23 [00:00<00:03,  6.59it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 41.19it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:09<00:00,  9.41s/it]100%|██████████| 1/1 [00:09<00:00,  9.41s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.63s/it]100%|██████████| 1/1 [00:11<00:00, 11.63s/it]
  0%|          | 0/320 [00:00<?, ?it/s]  0%|          | 1/320 [00:00<02:20,  2.26it/s]  1%|▏         | 4/320 [00:00<00:35,  9.01it/s]  2%|▏         | 7/320 [00:00<00:21, 14.32it/s]  3%|▎         | 10/320 [00:00<00:17, 18.01it/s]  4%|▍         | 13/320 [00:00<00:15, 20.46it/s]  5%|▌         | 16/320 [00:00<00:13, 22.03it/s]  6%|▌         | 19/320 [00:01<00:13, 23.06it/s]  7%|▋         | 22/320 [00:01<00:12, 23.84it/s]  8%|▊         | 25/320 [00:01<00:12, 24.24it/s]  9%|▉         | 28/320 [00:01<00:11, 24.47it/s] 10%|▉         | 31/320 [00:01<00:11, 24.52it/s] 11%|█         | 34/320 [00:01<00:11, 24.57it/s] 12%|█▏        | 37/320 [00:02<00:29,  9.56it/s] 12%|█▎        | 40/320 [00:02<00:23, 11.78it/s] 13%|█▎        | 43/320 [00:02<00:19, 13.99it/s] 14%|█▍        | 46/320 [00:02<00:17, 15.88it/s] 15%|█▌        | 49/320 [00:03<00:29,  9.31it/s] 16%|█▋        | 52/320 [00:03<00:23, 11.20it/s] 17%|█▋        | 55/320 [00:03<00:19, 13.30it/s] 18%|█▊        | 58/320 [00:03<00:17, 15.24it/s] 19%|█▉        | 61/320 [00:04<00:26,  9.67it/s] 20%|██        | 64/320 [00:04<00:21, 11.70it/s] 21%|██        | 67/320 [00:04<00:18, 13.61it/s] 22%|██▏       | 69/320 [00:05<00:28,  8.78it/s] 22%|██▏       | 71/320 [00:05<00:25,  9.75it/s] 23%|██▎       | 73/320 [00:05<00:22, 11.05it/s] 23%|██▎       | 75/320 [00:05<00:30,  8.11it/s] 24%|██▍       | 77/320 [00:06<00:26,  9.14it/s] 25%|██▍       | 79/320 [00:06<00:22, 10.53it/s] 26%|██▌       | 82/320 [00:06<00:27,  8.50it/s] 26%|██▋       | 84/320 [00:06<00:25,  9.39it/s] 27%|██▋       | 86/320 [00:06<00:21, 10.72it/s] 28%|██▊       | 88/320 [00:07<00:31,  7.41it/s] 28%|██▊       | 90/320 [00:07<00:26,  8.74it/s] 29%|██▉       | 92/320 [00:07<00:22, 10.29it/s] 29%|██▉       | 94/320 [00:07<00:27,  8.16it/s] 30%|███       | 96/320 [00:08<00:24,  9.13it/s] 31%|███       | 98/320 [00:08<00:29,  7.52it/s] 31%|███▏      | 100/320 [00:08<00:25,  8.58it/s] 32%|███▏      | 102/320 [00:08<00:22,  9.48it/s] 32%|███▎      | 104/320 [00:09<00:28,  7.61it/s] 33%|███▎      | 105/320 [00:09<00:28,  7.51it/s] 33%|███▎      | 106/320 [00:09<00:28,  7.60it/s] 34%|███▍      | 108/320 [00:09<00:32,  6.57it/s] 34%|███▍      | 110/320 [00:10<00:28,  7.35it/s] 35%|███▌      | 112/320 [00:10<00:30,  6.81it/s] 35%|███▌      | 113/320 [00:10<00:29,  6.99it/s] 36%|███▌      | 114/320 [00:10<00:29,  6.93it/s] 36%|███▋      | 116/320 [00:11<00:33,  6.07it/s] 37%|███▋      | 118/320 [00:11<00:28,  7.14it/s] 38%|███▊      | 120/320 [00:11<00:32,  6.11it/s] 38%|███▊      | 122/320 [00:11<00:27,  7.26it/s] 38%|███▊      | 123/320 [00:12<00:34,  5.76it/s] 39%|███▉      | 124/320 [00:12<00:31,  6.13it/s] 39%|███▉      | 126/320 [00:12<00:25,  7.52it/s] 40%|███▉      | 127/320 [00:12<00:35,  5.44it/s] 40%|████      | 129/320 [00:13<00:28,  6.66it/s] 41%|████      | 130/320 [00:13<00:31,  6.08it/s] 41%|████      | 131/320 [00:13<00:33,  5.63it/s] 42%|████▏     | 133/320 [00:13<00:31,  5.99it/s] 42%|████▏     | 134/320 [00:13<00:32,  5.79it/s] 42%|████▏     | 135/320 [00:14<00:29,  6.31it/s] 42%|████▎     | 136/320 [00:14<00:36,  5.08it/s] 43%|████▎     | 137/320 [00:14<00:34,  5.33it/s] 43%|████▎     | 139/320 [00:14<00:33,  5.41it/s] 44%|████▍     | 140/320 [00:15<00:31,  5.67it/s] 44%|████▍     | 142/320 [00:15<00:34,  5.16it/s] 45%|████▍     | 143/320 [00:15<00:32,  5.52it/s] 45%|████▌     | 145/320 [00:16<00:33,  5.29it/s] 46%|████▌     | 146/320 [00:16<00:32,  5.43it/s] 46%|████▋     | 148/320 [00:16<00:32,  5.24it/s] 47%|████▋     | 149/320 [00:16<00:29,  5.78it/s] 47%|████▋     | 150/320 [00:17<00:34,  4.92it/s] 47%|████▋     | 151/320 [00:17<00:32,  5.14it/s] 48%|████▊     | 153/320 [00:17<00:34,  4.91it/s] 48%|████▊     | 154/320 [00:17<00:31,  5.27it/s] 49%|████▉     | 156/320 [00:18<00:33,  4.86it/s] 49%|████▉     | 157/320 [00:18<00:30,  5.35it/s] 50%|████▉     | 159/320 [00:18<00:32,  4.98it/s] 50%|█████     | 160/320 [00:18<00:30,  5.29it/s] 50%|█████     | 161/320 [00:19<00:30,  5.25it/s] 51%|█████     | 162/320 [00:19<00:31,  4.96it/s] 51%|█████     | 163/320 [00:19<00:32,  4.84it/s] 51%|█████▏    | 164/320 [00:19<00:32,  4.74it/s] 52%|█████▏    | 165/320 [00:19<00:32,  4.80it/s] 52%|█████▏    | 166/320 [00:20<00:33,  4.66it/s] 52%|█████▏    | 167/320 [00:20<00:34,  4.47it/s] 52%|█████▎    | 168/320 [00:20<00:32,  4.71it/s] 53%|█████▎    | 169/320 [00:20<00:32,  4.63it/s] 53%|█████▎    | 170/320 [00:21<00:31,  4.72it/s] 53%|█████▎    | 171/320 [00:21<00:30,  4.85it/s] 54%|█████▍    | 172/320 [00:21<00:35,  4.18it/s] 54%|█████▍    | 173/320 [00:21<00:36,  4.06it/s] 54%|█████▍    | 174/320 [00:22<00:33,  4.41it/s] 55%|█████▍    | 175/320 [00:22<00:34,  4.22it/s] 55%|█████▌    | 176/320 [00:22<00:31,  4.54it/s] 55%|█████▌    | 177/320 [00:22<00:35,  4.07it/s] 56%|█████▌    | 178/320 [00:22<00:30,  4.63it/s] 56%|█████▌    | 179/320 [00:23<00:34,  4.13it/s] 56%|█████▋    | 180/320 [00:23<00:30,  4.64it/s] 57%|█████▋    | 181/320 [00:23<00:35,  3.95it/s] 57%|█████▋    | 182/320 [00:23<00:31,  4.42it/s] 57%|█████▋    | 183/320 [00:24<00:35,  3.87it/s] 57%|█████▊    | 184/320 [00:24<00:29,  4.54it/s] 58%|█████▊    | 185/320 [00:24<00:34,  3.92it/s] 58%|█████▊    | 186/320 [00:24<00:29,  4.56it/s] 58%|█████▊    | 187/320 [00:25<00:33,  3.96it/s] 59%|█████▉    | 188/320 [00:25<00:31,  4.20it/s] 59%|█████▉    | 189/320 [00:25<00:36,  3.61it/s] 59%|█████▉    | 190/320 [00:25<00:30,  4.33it/s] 60%|█████▉    | 191/320 [00:26<00:35,  3.60it/s] 60%|██████    | 192/320 [00:26<00:28,  4.46it/s] 60%|██████    | 193/320 [00:26<00:34,  3.64it/s] 61%|██████    | 195/320 [00:27<00:32,  3.82it/s] 62%|██████▏   | 197/320 [00:27<00:31,  3.85it/s] 62%|██████▏   | 199/320 [00:28<00:31,  3.88it/s] 63%|██████▎   | 201/320 [00:28<00:30,  3.92it/s] 63%|██████▎   | 203/320 [00:29<00:29,  3.90it/s] 64%|██████▍   | 205/320 [00:29<00:29,  3.87it/s] 65%|██████▍   | 207/320 [00:30<00:29,  3.85it/s] 65%|██████▌   | 209/320 [00:30<00:28,  3.83it/s] 66%|██████▌   | 211/320 [00:31<00:28,  3.82it/s] 66%|██████▋   | 212/320 [00:31<00:26,  4.11it/s] 67%|██████▋   | 213/320 [00:31<00:26,  4.02it/s] 67%|██████▋   | 214/320 [00:32<00:27,  3.82it/s] 67%|██████▋   | 215/320 [00:32<00:28,  3.74it/s] 68%|██████▊   | 216/320 [00:32<00:29,  3.57it/s] 68%|██████▊   | 217/320 [00:32<00:28,  3.56it/s] 68%|██████▊   | 218/320 [00:33<00:29,  3.44it/s] 68%|██████▊   | 219/320 [00:33<00:28,  3.54it/s] 69%|██████▉   | 220/320 [00:33<00:29,  3.41it/s] 69%|██████▉   | 221/320 [00:34<00:28,  3.43it/s] 69%|██████▉   | 222/320 [00:34<00:28,  3.43it/s] 70%|██████▉   | 223/320 [00:34<00:27,  3.47it/s] 70%|███████   | 224/320 [00:35<00:28,  3.43it/s] 70%|███████   | 225/320 [00:35<00:28,  3.37it/s] 71%|███████   | 226/320 [00:35<00:28,  3.29it/s] 71%|███████   | 227/320 [00:35<00:28,  3.25it/s] 71%|███████▏  | 228/320 [00:36<00:26,  3.41it/s] 72%|███████▏  | 229/320 [00:36<00:27,  3.26it/s] 72%|███████▏  | 230/320 [00:36<00:27,  3.24it/s] 72%|███████▏  | 231/320 [00:37<00:27,  3.28it/s] 72%|███████▎  | 232/320 [00:37<00:26,  3.28it/s] 73%|███████▎  | 233/320 [00:37<00:28,  3.03it/s] 73%|███████▎  | 234/320 [00:38<00:28,  3.02it/s] 73%|███████▎  | 235/320 [00:38<00:27,  3.07it/s] 74%|███████▍  | 236/320 [00:38<00:26,  3.14it/s] 74%|███████▍  | 237/320 [00:39<00:26,  3.18it/s] 74%|███████▍  | 238/320 [00:39<00:25,  3.19it/s] 75%|███████▍  | 239/320 [00:39<00:25,  3.19it/s] 75%|███████▌  | 240/320 [00:40<00:25,  3.19it/s] 75%|███████▌  | 241/320 [00:40<00:24,  3.17it/s] 76%|███████▌  | 242/320 [00:40<00:24,  3.18it/s] 76%|███████▌  | 243/320 [00:41<00:24,  3.19it/s] 76%|███████▋  | 244/320 [00:41<00:23,  3.18it/s] 77%|███████▋  | 245/320 [00:41<00:24,  3.09it/s] 77%|███████▋  | 246/320 [00:42<00:23,  3.09it/s] 77%|███████▋  | 247/320 [00:42<00:23,  3.10it/s] 78%|███████▊  | 248/320 [00:42<00:23,  3.13it/s] 78%|███████▊  | 249/320 [00:42<00:22,  3.14it/s] 78%|███████▊  | 250/320 [00:43<00:22,  3.12it/s] 78%|███████▊  | 251/320 [00:43<00:22,  3.12it/s] 79%|███████▉  | 252/320 [00:43<00:21,  3.10it/s] 79%|███████▉  | 253/320 [00:44<00:21,  3.11it/s] 79%|███████▉  | 254/320 [00:44<00:21,  3.11it/s] 80%|███████▉  | 255/320 [00:44<00:20,  3.10it/s] 80%|████████  | 256/320 [00:45<00:20,  3.09it/s] 80%|████████  | 257/320 [00:45<00:20,  3.08it/s] 81%|████████  | 258/320 [00:45<00:20,  3.09it/s] 81%|████████  | 259/320 [00:46<00:19,  3.07it/s] 81%|████████▏ | 260/320 [00:46<00:19,  3.06it/s] 82%|████████▏ | 261/320 [00:46<00:19,  3.04it/s] 82%|████████▏ | 262/320 [00:47<00:19,  3.03it/s] 82%|████████▏ | 263/320 [00:47<00:18,  3.02it/s] 82%|████████▎ | 264/320 [00:47<00:18,  3.01it/s] 83%|████████▎ | 265/320 [00:48<00:18,  2.99it/s] 83%|████████▎ | 266/320 [00:48<00:18,  2.98it/s] 83%|████████▎ | 267/320 [00:48<00:17,  2.96it/s] 84%|████████▍ | 268/320 [00:49<00:17,  2.97it/s] 84%|████████▍ | 269/320 [00:49<00:17,  2.96it/s] 84%|████████▍ | 270/320 [00:49<00:17,  2.94it/s] 85%|████████▍ | 271/320 [00:50<00:16,  2.92it/s] 85%|████████▌ | 272/320 [00:50<00:16,  2.93it/s] 85%|████████▌ | 273/320 [00:50<00:16,  2.93it/s] 86%|████████▌ | 274/320 [00:51<00:15,  2.90it/s] 86%|████████▌ | 275/320 [00:51<00:15,  2.84it/s] 86%|████████▋ | 276/320 [00:52<00:15,  2.84it/s] 87%|████████▋ | 277/320 [00:52<00:15,  2.86it/s] 87%|████████▋ | 278/320 [00:52<00:14,  2.88it/s] 87%|████████▋ | 279/320 [00:53<00:14,  2.87it/s] 88%|████████▊ | 280/320 [00:53<00:13,  2.86it/s] 88%|████████▊ | 281/320 [00:53<00:14,  2.65it/s] 88%|████████▊ | 282/320 [00:54<00:14,  2.69it/s] 88%|████████▊ | 283/320 [00:54<00:13,  2.72it/s] 89%|████████▉ | 284/320 [00:54<00:13,  2.75it/s] 89%|████████▉ | 285/320 [00:55<00:12,  2.77it/s] 89%|████████▉ | 286/320 [00:55<00:12,  2.77it/s] 90%|████████▉ | 287/320 [00:55<00:11,  2.78it/s] 90%|█████████ | 288/320 [00:56<00:11,  2.73it/s] 90%|█████████ | 289/320 [00:56<00:11,  2.74it/s] 91%|█████████ | 290/320 [00:57<00:10,  2.77it/s] 91%|█████████ | 291/320 [00:57<00:10,  2.76it/s] 91%|█████████▏| 292/320 [00:57<00:10,  2.74it/s] 92%|█████████▏| 293/320 [00:58<00:09,  2.75it/s] 92%|█████████▏| 294/320 [00:58<00:09,  2.76it/s] 92%|█████████▏| 295/320 [00:58<00:09,  2.74it/s] 92%|█████████▎| 296/320 [00:59<00:08,  2.75it/s] 93%|█████████▎| 297/320 [00:59<00:08,  2.75it/s] 93%|█████████▎| 298/320 [01:00<00:08,  2.75it/s] 93%|█████████▎| 299/320 [01:00<00:07,  2.75it/s] 94%|█████████▍| 300/320 [01:00<00:07,  2.73it/s] 94%|█████████▍| 301/320 [01:01<00:06,  2.72it/s] 94%|█████████▍| 302/320 [01:01<00:06,  2.71it/s] 95%|█████████▍| 303/320 [01:01<00:06,  2.69it/s] 95%|█████████▌| 304/320 [01:02<00:05,  2.69it/s] 95%|█████████▌| 305/320 [01:02<00:05,  2.69it/s] 96%|█████████▌| 306/320 [01:02<00:05,  2.69it/s] 96%|█████████▌| 307/320 [01:03<00:04,  2.68it/s] 96%|█████████▋| 308/320 [01:03<00:04,  2.68it/s] 97%|█████████▋| 309/320 [01:04<00:04,  2.67it/s] 97%|█████████▋| 310/320 [01:04<00:03,  2.66it/s] 97%|█████████▋| 311/320 [01:04<00:03,  2.65it/s] 98%|█████████▊| 312/320 [01:05<00:03,  2.63it/s] 98%|█████████▊| 313/320 [01:05<00:02,  2.64it/s] 98%|█████████▊| 314/320 [01:06<00:02,  2.62it/s] 98%|█████████▊| 315/320 [01:06<00:01,  2.61it/s] 98%|█████████▊| 315/320 [01:06<00:01,  4.72it/s]
Traceback (most recent call last):
  File "/home/hanshis/workspace/LongContextInfer/benchmark_ori.py", line 41, in <module>
    outputs = model(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 984, in forward
    outputs = self.model(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 868, in forward
    layer_outputs = decoder_layer(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 619, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 528, in forward
    past_kv = torch.cat([past_kv, torch.empty(bsz, q.size(1), 2, kv.size(3), kv.size(4), dtype=kv.dtype, device=kv.device)], 1)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 494.00 MiB. GPU 0 has a total capacty of 44.32 GiB of which 483.81 MiB is free. Including non-PyTorch memory, this process has 43.83 GiB memory in use. Of the allocated memory 43.16 GiB is allocated by PyTorch, and 183.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
>>>> Flash Attention installed
>>>> Flash RoPE installed
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.62s/it]
Resolving data files:   0%|          | 0/23 [00:00<?, ?it/s]Resolving data files:   4%|▍         | 1/23 [00:00<00:12,  1.77it/s]Resolving data files: 100%|██████████| 23/23 [00:00<00:00, 36.88it/s]
/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:08<00:00,  8.95s/it]100%|██████████| 1/1 [00:08<00:00,  8.95s/it]
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:11<00:00, 11.39s/it]100%|██████████| 1/1 [00:11<00:00, 11.39s/it]
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:00<04:10,  1.99it/s]  1%|          | 4/500 [00:00<01:00,  8.18it/s]  1%|▏         | 7/500 [00:00<00:36, 13.33it/s]  2%|▏         | 10/500 [00:00<00:28, 17.35it/s]  3%|▎         | 13/500 [00:00<00:24, 20.22it/s]  3%|▎         | 16/500 [00:01<00:21, 22.05it/s]  4%|▍         | 19/500 [00:01<00:20, 23.20it/s]  4%|▍         | 22/500 [00:01<00:19, 24.11it/s]  5%|▌         | 25/500 [00:01<00:19, 24.70it/s]  6%|▌         | 28/500 [00:01<00:18, 25.04it/s]  6%|▌         | 31/500 [00:01<00:18, 25.31it/s]  7%|▋         | 34/500 [00:01<00:18, 25.38it/s]  7%|▋         | 37/500 [00:02<00:47,  9.68it/s]  8%|▊         | 40/500 [00:02<00:38, 11.95it/s]  9%|▊         | 43/500 [00:02<00:32, 14.21it/s]  9%|▉         | 46/500 [00:02<00:27, 16.35it/s] 10%|▉         | 49/500 [00:03<00:47,  9.53it/s] 10%|█         | 52/500 [00:03<00:39, 11.46it/s] 11%|█         | 55/500 [00:03<00:32, 13.61it/s] 12%|█▏        | 58/500 [00:03<00:28, 15.57it/s] 12%|█▏        | 61/500 [00:04<00:44,  9.80it/s] 13%|█▎        | 64/500 [00:04<00:36, 11.87it/s] 13%|█▎        | 67/500 [00:04<00:31, 13.83it/s] 14%|█▍        | 69/500 [00:05<00:48,  8.97it/s] 14%|█▍        | 71/500 [00:05<00:42, 10.11it/s] 15%|█▍        | 74/500 [00:05<00:34, 12.39it/s] 15%|█▌        | 76/500 [00:05<00:46,  9.08it/s] 16%|█▌        | 78/500 [00:05<00:42,  9.96it/s] 16%|█▌        | 81/500 [00:06<00:34, 12.27it/s] 17%|█▋        | 83/500 [00:06<00:48,  8.58it/s] 17%|█▋        | 85/500 [00:06<00:43,  9.62it/s] 18%|█▊        | 88/500 [00:07<00:49,  8.35it/s] 18%|█▊        | 90/500 [00:07<00:44,  9.19it/s] 18%|█▊        | 92/500 [00:07<00:37, 10.75it/s] 19%|█▉        | 94/500 [00:07<00:48,  8.43it/s] 19%|█▉        | 96/500 [00:07<00:43,  9.35it/s] 20%|█▉        | 98/500 [00:08<00:52,  7.61it/s] 20%|██        | 100/500 [00:08<00:46,  8.64it/s] 20%|██        | 102/500 [00:08<00:41,  9.48it/s] 21%|██        | 104/500 [00:08<00:51,  7.68it/s] 21%|██        | 105/500 [00:09<00:52,  7.56it/s] 21%|██▏       | 107/500 [00:09<00:43,  8.99it/s] 22%|██▏       | 109/500 [00:09<00:54,  7.18it/s] 22%|██▏       | 110/500 [00:09<00:54,  7.19it/s] 22%|██▏       | 112/500 [00:10<00:57,  6.75it/s] 23%|██▎       | 113/500 [00:10<00:55,  6.93it/s] 23%|██▎       | 114/500 [00:10<00:55,  7.00it/s] 23%|██▎       | 116/500 [00:10<01:01,  6.27it/s] 23%|██▎       | 117/500 [00:10<00:58,  6.56it/s] 24%|██▍       | 119/500 [00:11<00:46,  8.12it/s] 24%|██▍       | 120/500 [00:11<01:06,  5.68it/s] 24%|██▍       | 122/500 [00:11<00:52,  7.21it/s] 25%|██▍       | 123/500 [00:11<01:07,  5.55it/s] 25%|██▍       | 124/500 [00:12<01:02,  6.06it/s] 25%|██▌       | 126/500 [00:12<00:49,  7.63it/s] 25%|██▌       | 127/500 [00:12<01:09,  5.38it/s] 26%|██▌       | 128/500 [00:12<01:01,  6.03it/s] 26%|██▌       | 130/500 [00:12<00:59,  6.19it/s] 26%|██▌       | 131/500 [00:13<01:04,  5.73it/s] 27%|██▋       | 133/500 [00:13<01:00,  6.09it/s] 27%|██▋       | 134/500 [00:13<01:03,  5.76it/s] 27%|██▋       | 136/500 [00:14<01:07,  5.43it/s] 27%|██▋       | 137/500 [00:14<01:04,  5.64it/s] 28%|██▊       | 139/500 [00:14<01:05,  5.50it/s] 28%|██▊       | 140/500 [00:14<01:01,  5.83it/s] 28%|██▊       | 142/500 [00:15<01:07,  5.30it/s] 29%|██▊       | 143/500 [00:15<01:03,  5.64it/s] 29%|██▉       | 145/500 [00:15<01:05,  5.38it/s] 29%|██▉       | 146/500 [00:15<01:03,  5.53it/s] 30%|██▉       | 148/500 [00:16<01:06,  5.28it/s] 30%|██▉       | 149/500 [00:16<00:59,  5.86it/s] 30%|███       | 150/500 [00:16<01:08,  5.09it/s] 30%|███       | 151/500 [00:16<01:07,  5.18it/s] 31%|███       | 153/500 [00:17<01:11,  4.87it/s] 31%|███       | 154/500 [00:17<01:04,  5.35it/s] 31%|███       | 156/500 [00:17<01:10,  4.88it/s] 31%|███▏      | 157/500 [00:18<01:04,  5.35it/s] 32%|███▏      | 159/500 [00:18<01:09,  4.88it/s] 32%|███▏      | 160/500 [00:18<01:03,  5.33it/s] 32%|███▏      | 161/500 [00:18<01:04,  5.28it/s] 32%|███▏      | 162/500 [00:19<01:07,  5.00it/s] 33%|███▎      | 163/500 [00:19<01:05,  5.11it/s] 33%|███▎      | 164/500 [00:19<01:09,  4.85it/s] 33%|███▎      | 165/500 [00:19<01:09,  4.82it/s] 33%|███▎      | 166/500 [00:19<01:10,  4.75it/s] 33%|███▎      | 167/500 [00:20<01:15,  4.39it/s] 34%|███▎      | 168/500 [00:20<01:09,  4.75it/s] 34%|███▍      | 169/500 [00:20<01:10,  4.67it/s] 34%|███▍      | 170/500 [00:20<01:09,  4.73it/s] 34%|███▍      | 171/500 [00:20<01:12,  4.56it/s] 34%|███▍      | 172/500 [00:21<01:10,  4.66it/s] 35%|███▍      | 173/500 [00:21<01:16,  4.27it/s] 35%|███▍      | 174/500 [00:21<01:09,  4.67it/s] 35%|███▌      | 175/500 [00:21<01:18,  4.16it/s] 35%|███▌      | 176/500 [00:22<01:09,  4.68it/s] 35%|███▌      | 177/500 [00:22<01:19,  4.07it/s] 36%|███▌      | 178/500 [00:22<01:08,  4.69it/s] 36%|███▌      | 179/500 [00:22<01:20,  4.00it/s] 36%|███▌      | 180/500 [00:23<01:08,  4.70it/s] 36%|███▌      | 181/500 [00:23<01:20,  3.97it/s] 36%|███▋      | 182/500 [00:23<01:07,  4.72it/s] 37%|███▋      | 183/500 [00:23<01:19,  4.00it/s] 37%|███▋      | 184/500 [00:23<01:06,  4.74it/s] 37%|███▋      | 185/500 [00:24<01:20,  3.89it/s] 37%|███▋      | 186/500 [00:24<01:06,  4.71it/s] 37%|███▋      | 187/500 [00:24<01:19,  3.94it/s] 38%|███▊      | 188/500 [00:24<01:06,  4.67it/s] 38%|███▊      | 189/500 [00:25<01:22,  3.75it/s] 38%|███▊      | 191/500 [00:25<01:18,  3.96it/s] 38%|███▊      | 192/500 [00:25<01:06,  4.62it/s] 39%|███▊      | 193/500 [00:26<01:19,  3.85it/s] 39%|███▉      | 194/500 [00:26<01:06,  4.61it/s] 39%|███▉      | 195/500 [00:26<01:22,  3.71it/s] 39%|███▉      | 197/500 [00:27<01:18,  3.88it/s] 40%|███▉      | 198/500 [00:27<01:06,  4.54it/s] 40%|███▉      | 199/500 [00:27<01:21,  3.68it/s] 40%|████      | 201/500 [00:28<01:18,  3.79it/s] 41%|████      | 203/500 [00:28<01:17,  3.82it/s] 41%|████      | 205/500 [00:29<01:17,  3.83it/s] 41%|████▏     | 207/500 [00:29<01:16,  3.84it/s] 42%|████▏     | 209/500 [00:30<01:16,  3.82it/s] 42%|████▏     | 211/500 [00:30<01:15,  3.81it/s] 42%|████▏     | 212/500 [00:31<01:10,  4.09it/s] 43%|████▎     | 213/500 [00:31<01:12,  3.98it/s] 43%|████▎     | 214/500 [00:31<01:14,  3.86it/s] 43%|████▎     | 215/500 [00:31<01:15,  3.77it/s] 43%|████▎     | 216/500 [00:32<01:18,  3.62it/s] 43%|████▎     | 217/500 [00:32<01:17,  3.66it/s] 44%|████▎     | 218/500 [00:32<01:19,  3.53it/s] 44%|████▍     | 219/500 [00:33<01:19,  3.51it/s] 44%|████▍     | 220/500 [00:33<01:20,  3.50it/s] 44%|████▍     | 221/500 [00:33<01:18,  3.56it/s] 44%|████▍     | 222/500 [00:33<01:19,  3.48it/s] 45%|████▍     | 223/500 [00:34<01:20,  3.45it/s] 45%|████▍     | 224/500 [00:34<01:20,  3.42it/s] 45%|████▌     | 225/500 [00:34<01:19,  3.44it/s] 45%|████▌     | 226/500 [00:35<01:20,  3.41it/s] 45%|████▌     | 227/500 [00:35<01:19,  3.44it/s] 46%|████▌     | 228/500 [00:35<01:20,  3.37it/s] 46%|████▌     | 229/500 [00:35<01:21,  3.34it/s] 46%|████▌     | 230/500 [00:36<01:20,  3.36it/s] 46%|████▌     | 231/500 [00:36<01:21,  3.32it/s] 46%|████▋     | 232/500 [00:36<01:20,  3.31it/s] 47%|████▋     | 233/500 [00:37<01:20,  3.33it/s] 47%|████▋     | 234/500 [00:37<01:20,  3.31it/s] 47%|████▋     | 235/500 [00:37<01:20,  3.29it/s] 47%|████▋     | 236/500 [00:38<01:19,  3.33it/s] 47%|████▋     | 237/500 [00:38<01:19,  3.29it/s] 48%|████▊     | 238/500 [00:38<01:19,  3.28it/s] 48%|████▊     | 239/500 [00:39<01:19,  3.27it/s] 48%|████▊     | 240/500 [00:39<01:19,  3.26it/s] 48%|████▊     | 241/500 [00:39<01:19,  3.24it/s] 48%|████▊     | 242/500 [00:39<01:19,  3.23it/s] 49%|████▊     | 243/500 [00:40<01:19,  3.22it/s] 49%|████▉     | 244/500 [00:40<01:19,  3.21it/s] 49%|████▉     | 245/500 [00:40<01:19,  3.19it/s] 49%|████▉     | 246/500 [00:41<01:19,  3.18it/s] 49%|████▉     | 247/500 [00:41<01:19,  3.17it/s] 50%|████▉     | 248/500 [00:41<01:19,  3.16it/s] 50%|████▉     | 249/500 [00:42<01:19,  3.16it/s] 50%|█████     | 250/500 [00:42<01:19,  3.15it/s] 50%|█████     | 251/500 [00:42<01:19,  3.15it/s] 50%|█████     | 252/500 [00:43<01:19,  3.13it/s] 51%|█████     | 253/500 [00:43<01:19,  3.11it/s] 51%|█████     | 254/500 [00:43<01:18,  3.12it/s] 51%|█████     | 255/500 [00:44<01:19,  3.10it/s] 51%|█████     | 256/500 [00:44<01:19,  3.08it/s] 51%|█████▏    | 257/500 [00:44<01:18,  3.08it/s] 52%|█████▏    | 258/500 [00:45<01:18,  3.08it/s] 52%|█████▏    | 259/500 [00:45<01:18,  3.06it/s] 52%|█████▏    | 260/500 [00:45<01:18,  3.05it/s] 52%|█████▏    | 261/500 [00:46<01:18,  3.04it/s] 52%|█████▏    | 262/500 [00:46<01:18,  3.04it/s] 53%|█████▎    | 263/500 [00:46<01:18,  3.02it/s] 53%|█████▎    | 264/500 [00:47<01:18,  3.01it/s] 53%|█████▎    | 265/500 [00:47<01:18,  2.99it/s] 53%|█████▎    | 266/500 [00:47<01:18,  2.98it/s] 53%|█████▎    | 267/500 [00:48<01:18,  2.98it/s] 54%|█████▎    | 268/500 [00:48<01:17,  2.99it/s] 54%|█████▍    | 269/500 [00:48<01:17,  2.98it/s] 54%|█████▍    | 270/500 [00:49<01:17,  2.97it/s] 54%|█████▍    | 271/500 [00:49<01:17,  2.95it/s] 54%|█████▍    | 272/500 [00:49<01:17,  2.93it/s] 55%|█████▍    | 273/500 [00:50<01:17,  2.93it/s] 55%|█████▍    | 274/500 [00:50<01:17,  2.92it/s] 55%|█████▌    | 275/500 [00:50<01:17,  2.91it/s] 55%|█████▌    | 276/500 [00:51<01:16,  2.91it/s] 55%|█████▌    | 277/500 [00:51<01:16,  2.90it/s] 56%|█████▌    | 278/500 [00:51<01:16,  2.90it/s] 56%|█████▌    | 279/500 [00:52<01:16,  2.90it/s] 56%|█████▌    | 280/500 [00:52<01:16,  2.88it/s] 56%|█████▌    | 281/500 [00:52<01:16,  2.87it/s] 56%|█████▋    | 282/500 [00:53<01:16,  2.86it/s] 57%|█████▋    | 283/500 [00:53<01:16,  2.84it/s] 57%|█████▋    | 284/500 [00:55<03:17,  1.09it/s] 57%|█████▋    | 285/500 [00:56<02:40,  1.34it/s] 57%|█████▋    | 286/500 [00:56<02:14,  1.59it/s] 57%|█████▋    | 287/500 [00:56<01:56,  1.83it/s] 58%|█████▊    | 288/500 [00:57<01:43,  2.04it/s] 58%|█████▊    | 289/500 [00:57<01:35,  2.20it/s] 58%|█████▊    | 290/500 [00:58<01:29,  2.35it/s] 58%|█████▊    | 291/500 [00:58<01:24,  2.47it/s] 58%|█████▊    | 292/500 [00:58<01:21,  2.56it/s] 59%|█████▊    | 293/500 [00:59<01:19,  2.61it/s] 59%|█████▉    | 294/500 [00:59<01:17,  2.67it/s] 59%|█████▉    | 295/500 [00:59<01:16,  2.69it/s] 59%|█████▉    | 296/500 [01:00<01:15,  2.69it/s] 59%|█████▉    | 297/500 [01:00<01:14,  2.71it/s] 60%|█████▉    | 298/500 [01:00<01:14,  2.70it/s] 60%|█████▉    | 299/500 [01:01<01:13,  2.72it/s] 60%|██████    | 300/500 [01:01<01:13,  2.72it/s] 60%|██████    | 301/500 [01:02<01:13,  2.71it/s] 60%|██████    | 302/500 [01:02<01:13,  2.70it/s] 61%|██████    | 303/500 [01:02<01:13,  2.70it/s] 61%|██████    | 304/500 [01:03<01:13,  2.68it/s] 61%|██████    | 305/500 [01:03<01:12,  2.68it/s] 61%|██████    | 306/500 [01:03<01:12,  2.68it/s] 61%|██████▏   | 307/500 [01:04<01:12,  2.67it/s] 62%|██████▏   | 308/500 [01:04<01:12,  2.66it/s] 62%|██████▏   | 309/500 [01:05<01:11,  2.65it/s] 62%|██████▏   | 310/500 [01:05<01:12,  2.63it/s] 62%|██████▏   | 311/500 [01:05<01:11,  2.63it/s] 62%|██████▏   | 312/500 [01:06<01:11,  2.62it/s] 63%|██████▎   | 313/500 [01:06<01:11,  2.63it/s] 63%|██████▎   | 314/500 [01:06<01:10,  2.62it/s] 63%|██████▎   | 315/500 [01:07<01:11,  2.58it/s] 63%|██████▎   | 315/500 [01:07<00:39,  4.65it/s]
Traceback (most recent call last):
  File "/home/hanshis/workspace/LongContextInfer/benchmark_ori.py", line 41, in <module>
    outputs = model(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 984, in forward
    outputs = self.model(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 868, in forward
    layer_outputs = decoder_layer(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 619, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hanshis/anaconda3/envs/torch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hanshis/workspace/LongContextInfer/models/modeling_llama_ori.py", line 528, in forward
    past_kv = torch.cat([past_kv, torch.empty(bsz, q.size(1), 2, kv.size(3), kv.size(4), dtype=kv.dtype, device=kv.device)], 1)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 494.00 MiB. GPU 0 has a total capacty of 44.32 GiB of which 483.81 MiB is free. Including non-PyTorch memory, this process has 43.83 GiB memory in use. Of the allocated memory 43.16 GiB is allocated by PyTorch, and 183.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
